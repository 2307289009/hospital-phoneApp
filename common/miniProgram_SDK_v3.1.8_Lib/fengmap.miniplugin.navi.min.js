// /**Released Version v3.1.8,BUILD 219,Time 1732862084447. Fengmap Mini SDK  es6, see: https://www.fengmap.com for details**/
Object.defineProperty(exports,"t",{value:!0});let i={MODULE_SHORTEST:1,MODULE_BEST:2},s={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},h={ZH:"zh",EN:"en"},e={Auto:1,SpecifiedDistance:2};class r{constructor(){}}Object.assign(r.prototype,{h(t,i){void 0===this.o&&(this.o={});var s=this.o;void 0===s[t]&&(s[t]=[]),-1===s[t].indexOf(i)&&s[t].push(i)},u(t,i){var s;return void 0!==this.o&&void 0!==(s=this.o)[t]&&-1!==s[t].indexOf(i)},l(t,i){var s;void 0!==this.o&&void 0!==(t=this.o[t])&&-1!==(s=t.indexOf(i))&&t.splice(s,1)},M(s){if(void 0!==this.o){var t=this.o[s.type];if(void 0!==t){var h=t.slice(0);for(let t=0,i=h.length;t<i;t++)h[t].call(this,s)}}}});class N{constructor(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=k(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;var i;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(i=k(),t=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=t),t)}}function k(){return("undefined"==typeof performance?Date:performance).now()}let n=[];for(let t=0;t<256;t++)n[t]=(t<16?"0":"")+t.toString(16);let a=1234567,o={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0,h=4294967295*Math.random()|0;return(n[255&t]+n[t>>8&255]+n[t>>16&255]+n[t>>24&255]+"-"+n[255&i]+n[i>>8&255]+"-"+n[i>>16&15|64]+n[i>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&h]+n[h>>8&255]+n[h>>16&255]+n[h>>24&255]).toUpperCase()},clamp:function(t,i,s){return Math.max(i,Math.min(s,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,s,h,r){return h+(t-i)*(r-h)/(s-i)},lerp:function(t,i,s){return(1-s)*t+s*i},smoothstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*(3-2*t)},smootherstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((a=16807*(a=void 0!==t?t%2147483647:a)%2147483647)-1)/2147483646},degToRad:function(t){return t*o.DEG2RAD},radToDeg:function(t){return t*o.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,s,h,r){var e=Math.cos,n=Math.sin,a=e(s/2),o=n(s/2),u=e((i+h)/2),l=n((i+h)/2),c=e((i-h)/2),f=n((i-h)/2),M=e((h-i)/2),v=n((h-i)/2);switch(r){case"XYX":t.set(a*l,o*c,o*f,a*u);break;case"YZY":t.set(o*f,a*l,o*c,a*u);break;case"ZXZ":t.set(o*c,o*f,a*l,a*u);break;case"XZX":t.set(a*l,o*v,o*M,a*u);break;case"YXY":t.set(o*M,a*l,o*v,a*u);break;case"ZYZ":t.set(o*v,o*M,a*l,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};class Y{constructor(t=0,i=0,s=0,h=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this.v=t,this.p=i,this.m=s,this.g=h}static slerp(t,i,s,h){return s.copy(t).slerp(i,h)}static slerpFlat(t,i,s,h,r,e,n){let a=s[h+0],o=s[h+1],u=s[h+2],l=s[h+3];var s=r[e+0],h=r[e+1],c=r[e+2],r=r[e+3];if(l!==r||a!==s||o!==h||u!==c){let t=1-n;var e=a*s+o*h+u*c+l*r,f=0<=e?1:-1,M=1-e*e,e=(M>Number.EPSILON&&(M=Math.sqrt(M),e=Math.atan2(M,e*f),t=Math.sin(t*e)/M,n=Math.sin(n*e)/M),n*f);a=a*t+s*e,o=o*t+h*e,u=u*t+c*e,l=l*t+r*e,t===1-n&&(M=1/Math.sqrt(a*a+o*o+u*u+l*l),a*=M,o*=M,u*=M,l*=M)}t[i]=a,t[i+1]=o,t[i+2]=u,t[i+3]=l}static multiplyQuaternionsFlat(t,i,s,h,r,e){var n=s[h],a=s[h+1],o=s[h+2],s=s[h+3],h=r[e],u=r[e+1],l=r[e+2],r=r[e+3];return t[i]=n*r+s*h+a*l-o*u,t[i+1]=a*r+s*u+o*h-n*l,t[i+2]=o*r+s*l+n*u-a*h,t[i+3]=s*r-n*h-a*u-o*l,t}get x(){return this.v}set x(t){this.v=t,this._()}get y(){return this.p}set y(t){this.p=t,this._()}get z(){return this.m}set z(t){this.m=t,this._()}get w(){return this.g}set w(t){this.g=t,this._()}set(t,i,s,h){return this.v=t,this.p=i,this.m=s,this.g=h,this._(),this}clone(){return new this.constructor(this.v,this.p,this.m,this.g)}copy(t){return this.v=t.x,this.p=t.y,this.m=t.z,this.g=t.w,this._(),this}setFromEuler(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var s=t.v,h=t.p,r=t.m,e=t._order,t=Math.cos,n=Math.sin,a=t(s/2),o=t(h/2),u=t(r/2),l=n(s/2),c=n(h/2),f=n(r/2);switch(e){case"XYZ":this.v=l*o*u+a*c*f,this.p=a*c*u-l*o*f,this.m=a*o*f+l*c*u,this.g=a*o*u-l*c*f;break;case"YXZ":this.v=l*o*u+a*c*f,this.p=a*c*u-l*o*f,this.m=a*o*f-l*c*u,this.g=a*o*u+l*c*f;break;case"ZXY":this.v=l*o*u-a*c*f,this.p=a*c*u+l*o*f,this.m=a*o*f+l*c*u,this.g=a*o*u-l*c*f;break;case"ZYX":this.v=l*o*u-a*c*f,this.p=a*c*u+l*o*f,this.m=a*o*f-l*c*u,this.g=a*o*u+l*c*f;break;case"YZX":this.v=l*o*u+a*c*f,this.p=a*c*u+l*o*f,this.m=a*o*f-l*c*u,this.g=a*o*u-l*c*f;break;case"XZY":this.v=l*o*u-a*c*f,this.p=a*c*u-l*o*f,this.m=a*o*f+l*c*u,this.g=a*o*u+l*c*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+e)}return!1!==i&&this._(),this}setFromAxisAngle(t,i){var i=i/2,s=Math.sin(i);return this.v=t.x*s,this.p=t.y*s,this.m=t.z*s,this.g=Math.cos(i),this._(),this}setFromRotationMatrix(t){var t=t.elements,i=t[0],s=t[4],h=t[8],r=t[1],e=t[5],n=t[9],a=t[2],o=t[6],t=t[10],u=i+e+t;return 0<u?(u=.5/Math.sqrt(u+1),this.g=.25/u,this.v=(o-n)*u,this.p=(h-a)*u,this.m=(r-s)*u):e<i&&t<i?(u=2*Math.sqrt(1+i-e-t),this.g=(o-n)/u,this.v=.25*u,this.p=(s+r)/u,this.m=(h+a)/u):t<e?(u=2*Math.sqrt(1+e-i-t),this.g=(h-a)/u,this.v=(s+r)/u,this.p=.25*u,this.m=(n+o)/u):(u=2*Math.sqrt(1+t-i-e),this.g=(r-s)/u,this.v=(h+a)/u,this.p=(n+o)/u,this.m=.25*u),this._(),this}setFromUnitVectors(t,i){let s=t.dot(i)+1;return s<1e-6?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this.v=-t.y,this.p=t.x,this.m=0):(this.v=0,this.p=-t.z,this.m=t.y)):(this.v=t.y*i.z-t.z*i.y,this.p=t.z*i.x-t.x*i.z,this.m=t.x*i.y-t.y*i.x),this.g=s,this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(o.clamp(this.dot(t),-1,1)))}rotateTowards(t,i){var s=this.angleTo(t);return 0!==s&&(i=Math.min(1,i/s),this.slerp(t,i)),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this.v*=-1,this.p*=-1,this.m*=-1,this._(),this}dot(t){return this.v*t.v+this.p*t.p+this.m*t.m+this.g*t.g}lengthSq(){return this.v*this.v+this.p*this.p+this.m*this.m+this.g*this.g}length(){return Math.sqrt(this.v*this.v+this.p*this.p+this.m*this.m+this.g*this.g)}normalize(){var t=this.length();return 0===t?(this.v=0,this.p=0,this.m=0,this.g=1):(this.v=this.v*(t=1/t),this.p=this.p*t,this.m=this.m*t,this.g=this.g*t),this._(),this}multiply(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,i){var s=t.v,h=t.p,r=t.m,t=t.g,e=i.v,n=i.p,a=i.m,i=i.g;return this.v=s*i+t*e+h*a-r*n,this.p=h*i+t*n+r*e-s*a,this.m=r*i+t*a+s*n-h*e,this.g=t*i-s*e-h*n-r*a,this._(),this}slerp(i,s){if(0!==s){if(1===s)return this.copy(i);var h,r,e=this.v,n=this.p,a=this.m,o=this.g;let t=o*i.g+e*i.v+n*i.p+a*i.m;t<0?(this.g=-i.g,this.v=-i.v,this.p=-i.p,this.m=-i.m,t=-t):this.copy(i),1<=t?(this.g=o,this.v=e,this.p=n,this.m=a):((i=1-t*t)<=Number.EPSILON?(this.g=(h=1-s)*o+s*this.g,this.v=h*e+s*this.v,this.p=h*n+s*this.p,this.m=h*a+s*this.m,this.normalize()):(h=Math.sqrt(i),i=Math.atan2(h,t),r=Math.sin((1-s)*i)/h,s=Math.sin(s*i)/h,this.g=o*r+this.g*s,this.v=e*r+this.v*s,this.p=n*r+this.p*s,this.m=a*r+this.m*s),this._())}return this}equals(t){return t.v===this.v&&t.p===this.p&&t.m===this.m&&t.g===this.g}fromArray(t,i=0){return this.v=t[i],this.p=t[i+1],this.m=t[i+2],this.g=t[i+3],this._(),this}toArray(t=[],i=0){return t[i]=this.v,t[i+1]=this.p,t[i+2]=this.m,t[i+3]=this.g,t}fromBufferAttribute(t,i){return this.v=t.getX(i),this.p=t.getY(i),this.m=t.getZ(i),this.g=t.getW(i),this}onChange(t){return this._=t,this}_(){}}class u{constructor(t=0,i=0,s=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=i,this.z=s}set(t,i,s){return void 0===s&&(s=this.z),this.x=t,this.y=i,this.z=s,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}sub(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(V.setFromEuler(t))}applyAxisAngle(t,i){return this.applyQuaternion(V.setFromAxisAngle(t,i))}applyMatrix3(t){var i=this.x,s=this.y,h=this.z,t=t.elements;return this.x=t[0]*i+t[3]*s+t[6]*h,this.y=t[1]*i+t[4]*s+t[7]*h,this.z=t[2]*i+t[5]*s+t[8]*h,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){var i=this.x,s=this.y,h=this.z,t=t.elements,r=1/(t[3]*i+t[7]*s+t[11]*h+t[15]);return this.x=(t[0]*i+t[4]*s+t[8]*h+t[12])*r,this.y=(t[1]*i+t[5]*s+t[9]*h+t[13])*r,this.z=(t[2]*i+t[6]*s+t[10]*h+t[14])*r,this}applyQuaternion(t){var i=this.x,s=this.y,h=this.z,r=t.x,e=t.y,n=t.z,t=t.w,a=t*i+e*h-n*s,o=t*s+n*i-r*h,u=t*h+r*s-e*i,i=-r*i-e*s-n*h;return this.x=a*t+i*-r+o*-n-u*-e,this.y=o*t+i*-e+u*-r-a*-n,this.z=u*t+i*-n+a*-e-o*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){var i=this.x,s=this.y,h=this.z,t=t.elements;return this.x=t[0]*i+t[4]*s+t[8]*h,this.y=t[1]*i+t[5]*s+t[9]*h,this.z=t[2]*i+t[6]*s+t[10]*h,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}clampLength(t,i){var s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(i,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}lerpVectors(t,i,s){return this.x=t.x+(i.x-t.x)*s,this.y=t.y+(i.y-t.y)*s,this.z=t.z+(i.z-t.z)*s,this}cross(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)}crossVectors(t,i){var s=t.x,h=t.y,t=t.z,r=i.x,e=i.y,i=i.z;return this.x=h*i-t*e,this.y=t*r-s*i,this.z=s*e-h*r,this}projectOnVector(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))}projectOnPlane(t){return l.copy(this).projectOnVector(t),this.sub(l)}reflect(t){return this.sub(l.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(o.clamp(t,-1,1)))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){var i=this.x-t.x,s=this.y-t.y,t=this.z-t.z;return i*i+s*s+t*t}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,i,s){var h=Math.sin(i)*t;return this.x=h*Math.sin(s),this.y=Math.cos(i)*t,this.z=h*Math.cos(s),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,i,s){return this.x=t*Math.sin(i),this.y=s,this.z=t*Math.cos(i),this}setFromMatrixPosition(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(t){var i=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=s,this.z=t,this}setFromMatrixColumn(t,i){return this.fromArray(t.elements,4*i)}setFromMatrix3Column(t,i){return this.fromArray(t.elements,3*i)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}fromBufferAttribute(t,i,s){return void 0!==s&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}let l=new u,V=new Y;class c{constructor(){this.R={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.T={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}get min(){return this.R}get max(){return this.T}get center(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}get size(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}copy(t){return this.T.x=t.max.x,this.T.y=t.max.y,this.R.x=t.min.x,this.R.y=t.min.y,this}clone(){return(new c).copy(this)}reset(){this.R={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.T={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}toObject(){return{min:this.min,max:this.max,center:this.center,size:this.size}}expand(t){this.O(t)}expandByCoords(t){this.L(t)}valid(){return this.A()}isCross(t){let i=!0;return t.max.x<this.min.x&&(i=!1),t.min.x>this.max.x&&(i=!1),t.max.y<this.min.y&&(i=!1),i=t.min.y>this.max.y?!1:i}}Object.assign(c.prototype,{A(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},O(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},L(t){t&&0!=t.length&&t.forEach(t=>{t.x<this.min.x&&(this.min.x=t.x),t.y<this.min.y&&(this.min.y=t.y),t.x>this.max.x&&(this.max.x=t.x),t.y>this.max.y&&(this.max.y=t.y)})}});let j={triangulate:function(a,o,u){u=u||2;var l=o&&o.length,c=l?o[0]*u:a.length;let f=Z(a,0,c,u,!0);var M=[];if(f&&f.next!==f.prev){let i,s,h,r,e,n,t;if(l&&(f=B(a,o,f,u)),a.length>80*u){i=h=a[0],s=r=a[1];for(let t=u;t<c;t+=u)e=a[t],n=a[t+1],e<i&&(i=e),n<s&&(s=n),e>h&&(h=e),n>r&&(r=n);t=0!==(t=Math.max(h-i,r-s))?1/t:0}v(f,M,u,i,s,t)}return M}};function Z(t,i,s,h,r){let e,n;if(r===0<nt(t,i,s,h))for(e=i;e<s;e+=h)n=et(e,t[e],t[e+1],n);else for(e=s-h;e>=i;e-=h)n=et(e,t[e],t[e+1],n);return n&&M(n,n.next)&&(b(n),n=n.next),n}function f(t,i){if(!t)return t;i=i||t;let s=t,h;do{if(h=!1,s.steiner||!M(s,s.next)&&0!==m(s.prev,s,s.next))s=s.next;else{if(b(s),(s=i=s.prev)===s.next)break;h=!0}}while(h||s!==i);return i}function v(h,r,e,n,a,o,u){if(h){!u&&o&&W(h,n,a,o);let t=h,i,s;for(;h.prev!==h.next;)if(i=h.prev,s=h.next,o?H(h,n,a,o):X(h))r.push(i.i/e),r.push(h.i/e),r.push(s.i/e),b(h),h=s.next,t=s.next;else if((h=s)===t){u?1===u?v(h=z(f(h),r,e),r,e,n,a,o,2):2===u&&U(h,r,e,n,a,o):v(f(h),r,e,n,a,o,1);break}}}function X(t){var i=t.prev,s=t,h=t.next;if(0<=m(i,s,h))return!1;let r=t.next.next;for(;r!==t.prev;){if(p(i.x,i.y,s.x,s.y,h.x,h.y,r.x,r.y)&&0<=m(r.prev,r,r.next))return!1;r=r.next}return!0}function H(t,i,s,h){var r=t.prev,e=t,n=t.next;if(0<=m(r,e,n))return!1;var a=(r.x<e.x?r.x<n.x?r:n:e.x<n.x?e:n).x,o=(r.y<e.y?r.y<n.y?r:n:e.y<n.y?e:n).y,u=(r.x>e.x?r.x>n.x?r:n:e.x>n.x?e:n).x,l=(r.y>e.y?r.y>n.y?r:n:e.y>n.y?e:n).y,c=d(a,o,i,s,h),f=d(u,l,i,s,h);let M=t.prevZ,v=t.nextZ;for(;M&&M.z>=c&&v&&v.z<=f;){if(M!==t.prev&&M!==t.next&&p(r.x,r.y,e.x,e.y,n.x,n.y,M.x,M.y)&&0<=m(M.prev,M,M.next))return!1;if(M=M.prevZ,v!==t.prev&&v!==t.next&&p(r.x,r.y,e.x,e.y,n.x,n.y,v.x,v.y)&&0<=m(v.prev,v,v.next))return!1;v=v.nextZ}for(;M&&M.z>=c;){if(M!==t.prev&&M!==t.next&&p(r.x,r.y,e.x,e.y,n.x,n.y,M.x,M.y)&&0<=m(M.prev,M,M.next))return!1;M=M.prevZ}for(;v&&v.z<=f;){if(v!==t.prev&&v!==t.next&&p(r.x,r.y,e.x,e.y,n.x,n.y,v.x,v.y)&&0<=m(v.prev,v,v.next))return!1;v=v.nextZ}return!0}function z(t,i,s){let h=t;do{var r=h.prev,e=h.next.next;!M(r,e)&&it(r,h,h.next,e)&&_(r,e)&&_(e,r)&&(i.push(r.i/s),i.push(h.i/s),i.push(e.i/s),b(h),b(h.next),h=t=e),h=h.next}while(h!==t);return f(h)}function U(t,i,s,h,r,e){let n=t;do{let t=n.next.next;for(;t!==n.prev;){var a;if(n.i!==t.i&&tt(n,t))return a=rt(n,t),n=f(n,n.next),a=f(a,a.next),v(n,i,s,h,r,e),void v(a,i,s,h,r,e);t=t.next}}while((n=n.next)!==t)}function B(t,i,s,h){var r=[];let e,n,a,o,u;for(e=0,n=i.length;e<n;e++)a=i[e]*h,o=e<n-1?i[e+1]*h:t.length,(u=Z(t,a,o,h,!1))===u.next&&(u.steiner=!0),r.push($(u));for(r.sort(q),e=0;e<r.length;e++)Q(r[e],s),s=f(s,s.next);return s}function q(t,i){return t.x-i.x}function Q(t,i){(i=K(t,i))&&(t=rt(i,t),f(i,i.next),f(t,t.next))}function K(s,t){let h=t;var r=s.x,e=s.y;let n=-1/0,a;do{if(e<=h.y&&e>=h.next.y&&h.next.y!==h.y){var i=h.x+(e-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(i<=r&&i>n){if((n=i)===r){if(e===h.y)return h;if(e===h.next.y)return h.next}a=h.x<h.next.x?h:h.next}}}while((h=h.next)!==t);if(!a)return null;if(r!==n){var o=a,u=a.x,l=a.y;let t=1/0,i;for(h=a;r>=h.x&&h.x>=u&&r!==h.x&&p(e<l?r:n,e,u,l,e<l?n:r,e,h.x,h.y)&&(i=Math.abs(e-h.y)/(r-h.x),_(h,s))&&(i<t||i===t&&(h.x>a.x||h.x===a.x&&G(a,h)))&&(a=h,t=i),(h=h.next)!==o;);}return a}function G(t,i){return m(t.prev,t,i.prev)<0&&m(i.next,t,t.next)<0}function W(t,i,s,h){let r=t;for(;null===r.z&&(r.z=d(r.x,r.y,i,s,h)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!==t;);r.prevZ.nextZ=null,r.prevZ=null,J(r)}function J(t){let i,s,h,r,e,n,a,o,u=1;do{for(s=t,t=null,e=null,n=0;s;){for(n++,h=s,a=0,i=0;i<u&&(a++,h=h.nextZ);i++);for(o=u;0<a||0<o&&h;)0!==a&&(0===o||!h||s.z<=h.z)?(s=(r=s).nextZ,a--):(h=(r=h).nextZ,o--),e?e.nextZ=r:t=r,r.prevZ=e,e=r;s=h}}while(e.nextZ=null,u*=2,1<n);return t}function d(t,i,s,h,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-h)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function $(t){let i=t,s=t;for(;(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),(i=i.next)!==t;);return s}function p(t,i,s,h,r,e,n,a){return 0<=(r-n)*(i-a)-(t-n)*(e-a)&&0<=(t-n)*(h-a)-(s-n)*(i-a)&&0<=(s-n)*(e-a)-(r-n)*(h-a)}function tt(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!st(t,i)&&(_(t,i)&&_(i,t)&&ht(t,i)&&(m(t.prev,t,i.prev)||m(t,i.prev,i))||M(t,i)&&0<m(t.prev,t,t.next)&&0<m(i.prev,i,i.next))}function m(t,i,s){return(i.y-t.y)*(s.x-i.x)-(i.x-t.x)*(s.y-i.y)}function M(t,i){return t.x===i.x&&t.y===i.y}function it(t,i,s,h){var r=y(m(t,i,s)),e=y(m(t,i,h)),n=y(m(s,h,t)),a=y(m(s,h,i));return r!==e&&n!==a||!!(0===r&&g(t,s,i)||0===e&&g(t,h,i)||0===n&&g(s,t,h)||0===a&&g(s,i,h))}function g(t,i,s){return i.x<=Math.max(t.x,s.x)&&i.x>=Math.min(t.x,s.x)&&i.y<=Math.max(t.y,s.y)&&i.y>=Math.min(t.y,s.y)}function y(t){return 0<t?1:t<0?-1:0}function st(t,i){let s=t;do{if(s.i!==t.i&&s.next.i!==t.i&&s.i!==i.i&&s.next.i!==i.i&&it(s,s.next,t,i))return!0}while((s=s.next)!==t);return!1}function _(t,i){return m(t.prev,t,t.next)<0?0<=m(t,i,t.next)&&0<=m(t,t.prev,i):m(t,i,t.prev)<0||m(t,t.next,i)<0}function ht(t,i){let s=t,h=!1;for(var r=(t.x+i.x)/2,e=(t.y+i.y)/2;s.y>e!=s.next.y>e&&s.next.y!==s.y&&r<(s.next.x-s.x)*(e-s.y)/(s.next.y-s.y)+s.x&&(h=!h),(s=s.next)!==t;);return h}function rt(t,i){var s=new E(t.i,t.x,t.y),h=new E(i.i,i.x,i.y),r=t.next,e=i.prev;return(t.next=i).prev=t,(s.next=r).prev=s,(h.next=s).prev=h,(e.next=h).prev=e,h}function et(t,i,s,h){t=new E(t,i,s);return h?(t.next=h.next,(t.prev=h).next.prev=t,h.next=t):(t.prev=t).next=t,t}function b(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,i,s){this.i=t,this.x=i,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nt(s,h,r,e){let n=0;for(let t=h,i=r-e;t<r;t+=e)n+=(s[i]-s[t])*(s[t+1]+s[i+1]),i=t;return n}let R={area:function(s){var h=s.length;let r=0;for(let t=h-1,i=0;i<h;t=i++)r+=s[t].x*s[i].y-s[i].x*s[t].y;return.5*r},isClockWise:function(t){return R.area(t)<0},triangulateShape:function(t,i){var s=[],h=[],r=[];ot(t),ut(s,t);let e=t.length;i.forEach(ot);for(let t=0;t<i.length;t++)h.push(e),e+=i[t].length,ut(s,i[t]);var n=j.triangulate(s,h);for(let t=0;t<n.length;t+=3)r.push(n.slice(t,t+3));return r},triangulate:function(i){let t=[];t.push(...i[0]);var s=[];for(let t=1;t<i.length;t++){var h=[];h.push(...i[t]),s.push(h)}if(!R.isClockWise(t)){t=t.reverse();for(let t=0,i=s.length;t<i;t++){var r=s[t];R.isClockWise(r)&&(s[t]=r.reverse())}}return R.triangulateShape(t,s)}};function at(t,i){return t.x===i.x&&t.y===i.y}function ot(t){var i=t.length;2<i&&at(t[i-1],t[0])&&t.pop()}function ut(i,s){for(let t=0;t<s.length;t++)i.push(s[t].x),i.push(s[t].y)}for(var w=[],t=0;t<256;t++)w[t]=(t<16?"0":"")+t.toString(16);var x={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0,h=4294967295*Math.random()|0;return(w[255&t]+w[t>>8&255]+w[t>>16&255]+w[t>>24&255]+"-"+w[255&i]+w[i>>8&255]+"-"+w[i>>16&15|64]+w[i>>24&255]+"-"+w[63&s|128]+w[s>>8&255]+"-"+w[s>>16&255]+w[s>>24&255]+w[255&h]+w[h>>8&255]+w[h>>16&255]+w[h>>24&255]).toUpperCase()},clamp:function(t,i,s){return Math.max(i,Math.min(s,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,s,h,r){return h+(t-i)*(r-h)/(s-i)},lerp:function(t,i,s){return(1-s)*t+s*i},smoothstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*(3-2*t)},smootherstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*x.DEG2RAD},radToDeg:function(t){return t*x.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,s,h,r){var e=Math.cos,n=Math.sin,a=e(s/2),s=n(s/2),o=e((i+h)/2),u=n((i+h)/2),l=e((i-h)/2),c=n((i-h)/2),e=e((h-i)/2),n=n((h-i)/2);"XYX"===r?t.set(a*u,s*l,s*c,a*o):"YZY"===r?t.set(s*c,a*u,s*l,a*o):"ZXZ"===r?t.set(s*l,s*c,a*u,a*o):"XZX"===r?t.set(a*u,s*n,s*e,a*o):"YXY"===r?t.set(s*e,a*u,s*n,a*o):"ZYZ"===r?t.set(s*n,s*e,a*u,a*o):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function T(t,i,s,h){this.v=t||0,this.p=i||0,this.m=s||0,this.g=void 0!==h?h:1}Object.assign(T,{slerp:function(t,i,s,h){return s.copy(t).slerp(i,h)},slerpFlat:function(t,i,s,h,r,e,n){var a,o,u,l=s[h+0],c=s[h+1],f=s[h+2],s=s[h+3],h=r[e+0],M=r[e+1],v=r[e+2],r=r[e+3];s===r&&l===h&&c===M&&f===v||(e=1-n,a=0<=(o=l*h+c*M+f*v+s*r)?1:-1,(u=1-o*o)>Number.EPSILON&&(u=Math.sqrt(u),o=Math.atan2(u,o*a),e=Math.sin(e*o)/u,n=Math.sin(n*o)/u),l=l*e+h*(o=n*a),c=c*e+M*o,f=f*e+v*o,s=s*e+r*o,e===1-n&&(l*=u=1/Math.sqrt(l*l+c*c+f*f+s*s),c*=u,f*=u,s*=u)),t[i]=l,t[i+1]=c,t[i+2]=f,t[i+3]=s}}),Object.defineProperties(T.prototype,{x:{get:function(){return this.v},set:function(t){this.v=t,this._()}},y:{get:function(){return this.p},set:function(t){this.p=t,this._()}},z:{get:function(){return this.m},set:function(t){this.m=t,this._()}},w:{get:function(){return this.g},set:function(t){this.g=t,this._()}}}),Object.assign(T.prototype,{isQuaternion:!0,set:function(t,i,s,h){return this.v=t,this.p=i,this.m=s,this.g=h,this._(),this},clone:function(){return new this.constructor(this.v,this.p,this.m,this.g)},copy:function(t){return this.v=t.x,this.p=t.y,this.m=t.z,this.g=t.w,this._(),this},setFromEuler:function(t,i){var s,h,r,e,n,a,o;if(t&&t.isEuler)return n=t.v,a=t.p,s=t.m,t=t.order,e=Math.cos,o=Math.sin,h=e(n/2),r=e(a/2),e=e(s/2),n=o(n/2),a=o(a/2),o=o(s/2),"XYZ"===t?(this.v=n*r*e+h*a*o,this.p=h*a*e-n*r*o,this.m=h*r*o+n*a*e,this.g=h*r*e-n*a*o):"YXZ"===t?(this.v=n*r*e+h*a*o,this.p=h*a*e-n*r*o,this.m=h*r*o-n*a*e,this.g=h*r*e+n*a*o):"ZXY"===t?(this.v=n*r*e-h*a*o,this.p=h*a*e+n*r*o,this.m=h*r*o+n*a*e,this.g=h*r*e-n*a*o):"ZYX"===t?(this.v=n*r*e-h*a*o,this.p=h*a*e+n*r*o,this.m=h*r*o-n*a*e,this.g=h*r*e+n*a*o):"YZX"===t?(this.v=n*r*e+h*a*o,this.p=h*a*e+n*r*o,this.m=h*r*o-n*a*e,this.g=h*r*e-n*a*o):"XZY"===t&&(this.v=n*r*e-h*a*o,this.p=h*a*e-n*r*o,this.m=h*r*o+n*a*e,this.g=h*r*e+n*a*o),!1!==i&&this._(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(t,i){var i=i/2,s=Math.sin(i);return this.v=t.x*s,this.p=t.y*s,this.m=t.z*s,this.g=Math.cos(i),this._(),this},setFromRotationMatrix:function(t){var i,t=t.elements,s=t[0],h=t[4],r=t[8],e=t[1],n=t[5],a=t[9],o=t[2],u=t[6],t=t[10],l=s+n+t;return 0<l?(i=.5/Math.sqrt(l+1),this.g=.25/i,this.v=(u-a)*i,this.p=(r-o)*i,this.m=(e-h)*i):n<s&&t<s?(i=2*Math.sqrt(1+s-n-t),this.g=(u-a)/i,this.v=.25*i,this.p=(h+e)/i,this.m=(r+o)/i):t<n?(i=2*Math.sqrt(1+n-s-t),this.g=(r-o)/i,this.v=(h+e)/i,this.p=.25*i,this.m=(a+u)/i):(i=2*Math.sqrt(1+t-s-n),this.g=(e-h)/i,this.v=(r+o)/i,this.p=(a+u)/i,this.m=.25*i),this._(),this},setFromUnitVectors:function(t,i){var s=t.dot(i)+1;return s<1e-6?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this.v=-t.y,this.p=t.x,this.m=0):(this.v=0,this.p=-t.z,this.m=t.y)):(this.v=t.y*i.z-t.z*i.y,this.p=t.z*i.x-t.x*i.z,this.m=t.x*i.y-t.y*i.x),this.g=s,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(x.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var s=this.angleTo(t);return 0!==s&&(i=Math.min(1,i/s),this.slerp(t,i)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.v*=-1,this.p*=-1,this.m*=-1,this._(),this},dot:function(t){return this.v*t.v+this.p*t.p+this.m*t.m+this.g*t.g},lengthSq:function(){return this.v*this.v+this.p*this.p+this.m*this.m+this.g*this.g},length:function(){return Math.sqrt(this.v*this.v+this.p*this.p+this.m*this.m+this.g*this.g)},normalize:function(){var t=this.length();return 0===t?(this.v=0,this.p=0,this.m=0,this.g=1):(this.v=this.v*(t=1/t),this.p=this.p*t,this.m=this.m*t,this.g=this.g*t),this._(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var s=t.v,h=t.p,r=t.m,t=t.g,e=i.v,n=i.p,a=i.m,i=i.g;return this.v=s*i+t*e+h*a-r*n,this.p=h*i+t*n+r*e-s*a,this.m=r*i+t*a+s*n-h*e,this.g=t*i-s*e-h*n-r*a,this._(),this},slerp:function(t,i){if(0!==i){if(1===i)return this.copy(t);var s,h=this.v,r=this.p,e=this.m,n=this.g,a=n*t.g+h*t.v+r*t.p+e*t.m;a<0?(this.g=-t.g,this.v=-t.v,this.p=-t.p,this.m=-t.m,a=-a):this.copy(t),1<=a?(this.g=n,this.v=h,this.p=r,this.m=e):((t=1-a*a)<=Number.EPSILON?(this.g=(s=1-i)*n+i*this.g,this.v=s*h+i*this.v,this.p=s*r+i*this.p,this.m=s*e+i*this.m,this.normalize()):(s=Math.sqrt(t),t=Math.atan2(s,a),a=Math.sin((1-i)*t)/s,i=Math.sin(i*t)/s,this.g=n*a+this.g*i,this.v=h*a+this.v*i,this.p=r*a+this.p*i,this.m=e*a+this.m*i),this._())}return this},equals:function(t){return t.v===this.v&&t.p===this.p&&t.m===this.m&&t.g===this.g},fromArray:function(t,i){return this.v=t[i=void 0===i?0:i],this.p=t[i+1],this.m=t[i+2],this.g=t[i+3],this._(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.v,t[i+1]=this.p,t[i+2]=this.m,t[i+3]=this.g,t},fromBufferAttribute:function(t,i){return this.v=t.getX(i),this.p=t.getY(i),this.m=t.getZ(i),this.g=t.getW(i),this},onChange:function(t){return this._=t,this},_:function(){}});var O=new L,lt=new T;function L(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0}Object.assign(L.prototype,{isVector3:!0,set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(lt.setFromEuler(t))},applyAxisAngle:function(t,i){return this.applyQuaternion(lt.setFromAxisAngle(t,i))},applyMatrix3:function(t){var i=this.x,s=this.y,h=this.z,t=t.elements;return this.x=t[0]*i+t[3]*s+t[6]*h,this.y=t[1]*i+t[4]*s+t[7]*h,this.z=t[2]*i+t[5]*s+t[8]*h,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var i=this.x,s=this.y,h=this.z,t=t.elements,r=1/(t[3]*i+t[7]*s+t[11]*h+t[15]);return this.x=(t[0]*i+t[4]*s+t[8]*h+t[12])*r,this.y=(t[1]*i+t[5]*s+t[9]*h+t[13])*r,this.z=(t[2]*i+t[6]*s+t[10]*h+t[14])*r,this},applyQuaternion:function(t){var i=this.x,s=this.y,h=this.z,r=t.x,e=t.y,n=t.z,t=t.w,a=t*i+e*h-n*s,o=t*s+n*i-r*h,u=t*h+r*s-e*i,i=-r*i-e*s-n*h;return this.x=a*t+i*-r+o*-n-u*-e,this.y=o*t+i*-e+u*-r-a*-n,this.z=u*t+i*-n+a*-e-o*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var i=this.x,s=this.y,h=this.z,t=t.elements;return this.x=t[0]*i+t[4]*s+t[8]*h,this.y=t[1]*i+t[5]*s+t[9]*h,this.z=t[2]*i+t[6]*s+t[10]*h,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},clampLength:function(t,i){var s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(i,s)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t)},cross:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)},crossVectors:function(t,i){var s=t.x,h=t.y,t=t.z,r=i.x,e=i.y,i=i.z;return this.x=h*i-t*e,this.y=t*r-s*i,this.z=s*e-h*r,this},projectOnVector:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))},projectOnPlane:function(t){return O.copy(this).projectOnVector(t),this.sub(O)},reflect:function(t){return this.sub(O.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(x.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y,t=this.z-t.z;return i*i+s*s+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,i,s){var h=Math.sin(i)*t;return this.x=h*Math.sin(s),this.y=Math.cos(i)*t,this.z=h*Math.cos(s),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,i,s){return this.x=t*Math.sin(i),this.y=s,this.z=t*Math.cos(i),this},setFromMatrixPosition:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=s,this.z=t,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},setFromMatrix3Column:function(t,i){return this.fromArray(t.elements,3*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromBufferAttribute:function(t,i,s){return void 0!==s&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}});let A=1e-5,ct=1e-5,I=.001,ft=Math.PI/180,Mt=180/Math.PI;class vt{constructor(){}}Object.assign(vt.prototype,{I(){return A},P(){return ft},F(){return Mt},D(t){return t<A&&t>-A},S(t){return t>A},C(t){return t<-A},N(t,i,s){i=(t.x-s.x)*(i.y-s.y)-(i.x-s.x)*(t.y-s.y);return Math.abs(i)<A?0:i},distanceOfTwoPoints(t,i){return t&&i?Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)):Number.NaN},distance(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},isPolygonContainPoint(h,r){let e=0;for(let s=0;s<h.length;s++){var n=h[s].x,a=h[s].y;let t=0,i=0;if(i=(s<h.length-1?(t=h[s+1].x,h[s+1]):(t=h[0].x,h[0])).y,n===r.x&&a===r.y||t===r.x&&i===r.y)return!0;if(i!==a){var o=n+(r.y-a)*(t-n)/(i-a);if(o===r.x)return!0;n!==t?o<=Math.max(n,t)&&o>=Math.min(n,t)&&o>r.x&&o!==n&&(o===t&&0<(a-r.y)*(i-r.y)?e+=2:e++):o<=Math.max(n,t)&&o>=Math.min(n,t)&&o>r.x&&(o===t&&0<(a-r.y)*(i-r.y)?e+=2:e++)}}return 0<e%2},isPolygonContainPoint2(i,s){var h=i.length;if(h<3)return!1;let r=h-1,e=!1,n=0;for(let t=0;t<h;t++){var a=i[t],o=i[r];a.y>s.y!=o.y>s.y&&s.x<(o.x-a.x)*(s.y-a.y)/(o.y-a.y)+a.x&&(e=!e,a.y>o.y?n++:n--),r=t}return 0!=n},isPolygonInPolygon(t,i){var s=Object.assign([],t),h=Object.assign([],i);s.push(s[0]),h.push(h[0]);for(let t=0;t<s.length-1;t++){var r=s[t];if(!this.isPolygonContainPoint(h,r)&&!this.isPolygonContainPoint2(h,r))return!1}for(let i=0;i<s.length-1;i++)for(let t=0;t<h.length-1;t++)if(this.k(s[i],s[i+1],h[t],h[t+1]).isintersect&&!this.Y(h[t],h[t+1],s[i])&&!this.Y(h[t],h[t+1],s[i+1]))return!1;return!0},V(t,i,s,h){return!(Math.max(t.x,i.x)<Math.min(s.x,h.x)||Math.max(t.y,i.y)<Math.min(s.y,h.y)||Math.max(s.x,h.x)<Math.min(t.x,i.x)||Math.max(s.y,h.y)<Math.min(t.y,i.y))},j(t,i,s,h){return!(Math.max(t.x,i.x)<Math.min(s.x,h.x)||Math.max(t.y,i.y)<Math.min(s.y,h.y)||Math.max(s.x,h.x)<Math.min(t.x,i.x)||Math.max(s.y,h.y)<Math.min(t.y,i.y)||0===this.N(s,i,t)&&0===this.N(i,h,t)||this.N(s,i,t)*this.N(i,h,t)<0||this.N(t,h,s)*this.N(h,i,s)<0)},Z(t,i,s){return!(t.x<i.x||t.y<i.y||t.x>s.x||s.y<t.y)},X(t,i,s){var h=Math.min(i.x,s.x),r=Math.max(i.x,s.x),e=Math.min(i.y,s.y),i=Math.max(i.y,s.y);return!(t.x<h||t.x>r||t.y<e||t.y>i)},H(t,i,s){var h=Math.min(s.x,i.x),r=Math.max(s.x,i.x),e=Math.min(s.y,i.y),s=Math.max(s.y,i.y);return!(t.x<h||t.x>r||t.y<e||t.y>s)},U(i,s,h){let r=!1;var e,n;for(let t=0;t<h;t++)e=s[t],n=s[(t+1)%h],(e.y<i.y&&n.y>=i.y||n.y<i.y&&e.y>=i.y)&&(e.x<=i.x||n.x<=i.x)&&e.x+(i.y-e.y)/(n.y-e.y)*(n.x-e.x)<i.x&&(r=!r);return r},B(t,i,s){return(t.x-i.x)*(s.y-i.y)==(s.x-i.x)*(t.y-i.y)&&Math.min(i.x,s.x)<=t.x&&t.x<=Math.max(i.x,s.x)&&Math.min(i.y,s.y)<=t.y&&t.y<=Math.max(i.y,s.y)},q(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},K(t,i){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)},G(t,i,s){let h;var r=i.x,i=i.y,e=s.x,s=s.y,n=t.x,t=t.y,a=e-r,o=s-i,u=a*a+o*o,l=n-r,c=t-i,f=l*l+c*c;return this.D(u)?h=this.D(f)?0:f:(o=(u=a/(a=Math.sqrt(u)))*l+(l=o/a)*c,h=this.S(o)?this.C(o-a)?(c=n-(r+o*u))*c+(a=t-(i+o*l))*a:(r=n-e)*r+(u=t-s)*u:f,this.D(h)?0:h)},W(t,i,s,h){let r;var e=i.x,n=i.y,a=s.x,o=s.y,u=t.x,t=t.y,l=a-e,c=o-n,f=Math.sqrt(l*l+c*c),M=u-e,v=t-n,d=Math.sqrt(M*M+v*v);return r=!this.D(f)&&(c=(l=l/f)*M+(M=c/f)*v,this.S(c))?this.C(c-f)?(f=u-(v=e+c*l),l=t-(e=n+c*M),n=Math.sqrt(f*f+l*l),h.x=v,h.y=e,n):(c=u-a,M=t-o,f=Math.sqrt(c*c+M*M),h.x=s.x,h.y=s.y,f):(h.x=i.x,h.y=i.y,d),this.D(r)?0:r},J(i,s){let h=0,r=0,e=0;for(let t=0;t<s;t++){var n=i[t],a=i[(t+1)%s],o=(n.x*a.y-n.y*a.x)/2;h+=o,r+=o*(n.x+a.x)/3,e+=o*(n.y+a.y)/3}return r/=h,e/=h,{x:r,y:e}},$(i){var s=R.triangulate([i]);let h=0,r=0,e=0;for(let t=0;t<s.length;t++){var n=i[s[t][0]],a=i[s[t][1]],o=i[s[t][2]],u={x:a.x-n.x,y:a.y-n.y},l={x:o.x-n.x,y:o.y-n.y},l=(u.x*l.y-l.x*u.y)/2,u=(h+=l,(n.x+a.x+o.x)/3);r+=u*l,e+=(n.y+a.y+o.y)/3*l}return{x:r/h,y:e/h}},tt(i,s){if(s<3)return 0;let h=0;for(let t=0;t<s;++t){var r=i[t],e=i[(t+1)%s];h+=r.x*e.y-r.y*e.x}return Math.abs(h/2)},it(t,i,s,h,r){var e;return this.j(t,i,s,h)?(e=(h.x-s.x)*(t.y-i.y)-(i.x-t.x)*(s.y-h.y),r.x=((t.y-s.y)*(i.x-t.x)*(h.x-s.x)+s.x*(h.y-s.y)*(i.x-t.x)-t.x*(i.y-t.y)*(h.x-s.x))/e,r.y=(i.y*(t.x-i.x)*(h.y-s.y)+(h.x-i.x)*(h.y-s.y)*(t.y-i.y)-h.y*(s.x-h.x)*(i.y-t.y))/(e=(t.x-i.x)*(h.y-s.y)-(i.y-t.y)*(s.x-h.x)),1):0},st(t,i,s,h,r){var e=Math.min(s.x,h.x),n=Math.max(s.x,h.x),a=Math.min(s.y,h.y),o=Math.max(s.y,h.y),u=t.x,l=t.y,c=s.x,f=s.y,M=h.x,v=h.y;if(90==i)return!(t.x<e||t.x>n||(n-e<I?t.y>=f&&t.y<=v||t.y>=v&&t.y<=f?(r.x=t.x,r.y=t.y,0):f<v&&t.x<f?(r.x=c,r.y=f,0):!(v<f&&t.x<v)||(r.x=M,r.y=v,0):(r.y=d=(v-f)/(M-c)*(u-c)+f,r.x=u,d<l||!this.H(r,s,h))));if(270==i)return!(t.x<e||t.x>n||(Math.abs(n-e<I)?t.y>=f&&t.y<=v||t.y>=v&&t.y<=f?(r.x=t.x,r.y=t.y,0):f<v&&t.y>v?(r.x=M,r.y=v,0):!(v<f&&t.y>f)||(r.x=c,r.y=f,0):(r.y=d=(v-f)/(M-c)*(u-c)+f,r.x=u,l<d||!this.H(r,s,h))));if(270!=i&&90!=i&&Math.abs(n-e<I)){var t=e,d=Math.tan(i/180*Math.PI)*(t-u)+l;if(r.y=d,r.x=t,this.H(r,s,h))return n=d-l,0<(e=t-u)/Math.sqrt(e*e+n*n)*Math.cos(i/180*Math.PI)}return Math.abs(o-a<=I)?(d=a,t=1/Math.tan(i/180*Math.PI)*(d-l)+u,r.x=t,r.y=d,!!this.H(r,s,h)&&(e=d-l,0<(n=t-u)/Math.sqrt(n*n+e*e)*Math.cos(i/180*Math.PI))):(t=l+(o=Math.tan(i/180*Math.PI))*((d=(f-l-((a=(v-f)/(M-c))*c-o*u))/(o-a))-u),r.x=d,r.y=t,!!this.H(r,s,h)&&(n=d-u,e=t-l,Math.abs(n)<=I&&Math.abs(e)<=I||0<n/Math.sqrt(n*n+e*e)*Math.cos(i/180*Math.PI)))},ht(t,i){return Math.abs(t.x-i.x)<A&&Math.abs(t.y-i.y)<A},rt(t,i,s,h){var r,e,n,a,o=t.x,u=t.y,l=i.x,c=i.y,f=s.x,M=s.y;return this.ht(t,i)||this.ht(t,s)?(h.x=o,h.y=u,!0):(n=Math.min(i.x,s.x),a=Math.max(i.x,s.x),r=Math.min(i.y,s.y),e=Math.max(i.y,s.y),Math.abs(l-f)<ct?(h.x=l,r<=(h.y=u)&&u<=e):Math.abs(c-M)<ct?(h.x=o,h.y=c,n<=o&&o<=a):(a=u+(r=-1/((M-c)/(f-l)))*((n=(c-u-((e=(M-c)/(f-l))*l-r*o))/(r-e))-o),h.x=n,h.y=a,!!this.H(h,i,s)||!(!this.ht(t,i)&&!this.ht(t,s))))},et(t,i){return{x:t.y*i.z-t.z*i.y,y:t.z*i.x-t.x*i.z,z:t.x*i.y-t.y*i.x}},nt(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},ot(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},ut(t,i){return t.x*i.x+t.y*i.y},lt(t,i){return t.x*i.y-t.y*i.x},ct(t){return Math.sqrt(t.x*t.x+t.y*t.y)},ft(t,i){var s,h;return 0==t.x&&0==t.y||0==i.x&&0==i.y?0:(s={x:i.x,y:i.y,z:0},s=this.et({x:t.x,y:t.y,z:0},s),h=this.ut(t,i),h=Math.acos(h/(this.ct(t)*this.ct(i))),0<s.z?h/Math.PI*180:360-h/Math.PI*180)},Mt(i,s,h,r){for(let t=0;t<h.length;t++){var e=h[t],n=h[(t+1)%h.length];if(1==this.it(i,s,e,n,r))return!0}return!1},vt(t,i,s,h,r){var e=Math.min(t.x,s.x,h.x),n=Math.max(t.x,s.x,h.x),a=Math.min(t.y,s.y,h.y),o=Math.max(t.y,s.y,h.y),n=Math.sqrt((n-e)*(n-e)+(o-a)*(o-a)),e=i/180*Math.PI,o=n*Math.cos(e)+t.x,a=n*Math.sin(e)+t.y;return 1==this.it(t,{x:o,y:a},s,h,r)},dt(i){var t={x:null,y:null};let s=0,h=0,r=i.length;1<i.length&&i[0].x===i[i.length-1].x&&i[0].y===i[i.length-1].y&&r--;for(let t=0;t<r;t++)s+=i[t].x,h+=i[t].y;return t.x=s/i.length,t.y=h/i.length,t},gt(t,i,s,h){var r=[],e=t.x-i,n=t.x+i,a=t.y-i,o=t.y+i,u=Math.min(s.x,h.x),l=Math.max(s.x,h.x),c=Math.min(s.y,h.y),f=Math.max(s.y,h.y);return l<e||n<u||f<a||o<c||(n=(t=((e=h.x-s.x)*(n=t.x-s.x)+(a=h.y-s.y)*(o=t.y-s.y))/(h=e*e+a*a))*t-(n*n+o*o-i*i)/h)<0||(o=Math.sqrt(n),h={x:s.x-e*(i=-t+o),y:s.y-a*i},e={x:s.x-e*(n=-t-o),y:s.y-a*n},i!==n&&(u<=h.x&&h.x<=l&&c<=h.y&&h.y<=f&&r.push(h),u<=e.x)&&e.x<=l&&c<=e.y&&e.y<=f&&r.push(e)),r},yt(t,i){return Math.abs(t.x-i.x)<=A&&Math.abs(t.y-i.y)<=A},_t(t,i,s){var h,r={};if(t.x!=i.x)return h=i=(i.y-t.y)/(i.x-t.x),r.x=(+s.x- -1*h*s.y-h*(i=t.y-i*t.x))/(h*h+1),r.y=(h*h*s.y- -1*h*s.x- -1*i)/(h*h+1),r;r.x=t.x,r.y=s.y},k(t,i,s,h){var r,e,n,a,o={point:null,isintersect:!1};return this.distanceOfTwoPoints(t,s)<.001||this.distanceOfTwoPoints(t,h)<.001?(o.isintersect=!0,o.point=t):this.distanceOfTwoPoints(i,s)<.001||this.distanceOfTwoPoints(i,h)<.001?(o.isintersect=!0,o.point=i):(r={x:i.x-t.x,y:i.y-t.y},e={x:h.x-s.x,y:h.y-s.y},h={x:h.x-t.x,y:h.y-t.y},i={x:i.x-s.x,y:i.y-s.y},n={x:-(s={x:s.x-t.x,y:s.y-t.y}).x,y:-s.y},a=this.lt(e,r),Math.abs(a)<=1e-5||this.lt(s,r)*this.lt(h,r)<=-5e-4&&this.lt(n,e)*this.lt(i,e)<-5e-4&&(h=this.lt(e,s)/a,o.point={x:t.x+r.x*h,y:t.y+r.y*h},o.isintersect=!0)),o},bt(t,i,s){return t.x===i.x&&(i.x=i.x+1),t.y===i.y&&(i.y=i.y+1),i.x===s.x&&(s.x=s.x+1),i.y===s.y&&(s.y=s.y+1),!(0<(i.x-t.x)*(s.y-i.y)-(i.y-t.y)*(s.x-i.x))},getAngle(t){var i=t.p1,t=t.p2,s=t.x-i.x,t=t.y-i.y,i=Math.sqrt(s*s+t*t),i=Math.asin(Math.abs(t)/i);return 0<s&&0<t?i:s<0&&0<t?Math.PI-i:s<0&&t<0?Math.PI+i:0<s&&t<0?2*Math.PI-i:0==s&&0<t?i:0==s&&t<0?3*Math.PI/2:0<s&&0==t?i:s<0&&0==t?Math.PI:null},Et(t){var i=this.distanceOfTwoPoints(t[0],t[1]),s=this.distanceOfTwoPoints(t[1],t[2]),t=this.distanceOfTwoPoints(t[0],t[2]),h=(i+s+t)/2;return Math.sqrt(h*(h-i)*(h-s)*(h-t))},Rt(t,i){var s,h,r,e,n;return this.W(t,i[0],i[1],{})<1e-4||this.W(t,i[0],i[2],{})<1e-4||this.W(t,i[1],i[2],{})<1e-4||(e={x:i[1].x-i[0].x,y:i[1].y-i[0].y},s={x:i[0].x-i[2].x,y:i[0].y-i[2].y},h={x:i[2].x-i[1].x,y:i[2].y-i[1].y},n={x:t.x-i[0].x,y:t.y-i[0].y},r={x:t.x-i[1].x,y:t.y-i[1].y},t={x:t.x-i[2].x,y:t.y-i[2].y},i=this.lt(e,n),e=this.lt(h,r),n=this.lt(s,t),i*e>A&&e*n>A)},wt(h,r,e){var n=e.length,a={isintersect:!1,start:null,end:null,type:0,outer:null},o=[];if(this.Rt(h,e)&&(a.start=h),this.Rt(r,e)&&(a.end=r),null!=a.start&&null!=a.end)a.isintersect=!0,a.type=1;else{let i=(e[1].x+e[2].x)/2,s=(e[1].y+e[2].y)/2;for(let t=1;t<n;t++){var u,l=this.k(h,r,e[t-1],e[t]);if(l.isintersect){if(null!=a.start)return a.end=l.point,a.isintersect=!0,a.outer="end",u=this.ft({x:i-e[0].x,y:s-e[0].y},{x:r.x-e[0].x,y:r.y-e[0].y}),a.type=0<(u=u<180?u:u-360)?2:3,a;if(null!=a.end)return a.start=l.point,a.isintersect=!0,a.outer="start",u=this.ft({x:i-e[0].x,y:s-e[0].y},{x:h.x-e[0].x,y:h.y-e[0].y}),a.type=0<(u=u<180?u:u-360)?2:3,a;o.push(l)}}var t,c=this.k(h,r,e[0],e[n-1]);if(c.isintersect){if(null!=a.start)return a.end=c.point,a.isintersect=!0,a.outer="end",t=this.ft({x:i-e[0].x,y:s-e[0].y},{x:r.x-e[0].x,y:r.y-e[0].y}),a.type=0<(t=t<180?t:t-360)?2:3,a;if(null!=a.end)return a.start=c.point,a.isintersect=!0,a.outer="start",t=this.ft({x:i-e[0].x,y:s-e[0].y},{x:h.x-e[0].x,y:h.y-e[0].y}),a.type=0<(t=t<180?t:t-360)?2:3,a;o.push(c)}2!=o.length||this.distanceOfTwoPoints(o[0].point,o[1].point)<.01||(this.distanceOfTwoPoints(o[0].point,h)<=this.distanceOfTwoPoints(o[0].point,r)?(a.start=o[0].point,a.end=o[1].point):(a.start=o[1].point,a.end=o[0].point),a.isintersect=!0,a.type=4)}return a},xt(i,s,h){var r=h.length,e={isintersect:!1,start:null,end:null},n=[];if(this.Rt(i,h)&&(e.start=i),this.Rt(s,h)&&(e.end=s),null!=e.start&&null!=e.end)e.isintersect=!0;else{for(let t=1;t<r;t++){var a=this.k(i,s,h[t-1],h[t]);if(a.isintersect){if(null!=e.start)return e.end=a.point,e.isintersect=!0,e;if(null!=e.end)return e.start=i,e.isintersect=!0,e;n.push(a)}}var t=this.k(i,s,h[0],h[r-1]);if(t.isintersect){if(null!=e.start)return e.end=t.point,e.isintersect=!0,e;if(null!=e.end)return e.start=i,e.isintersect=!0,e;n.push(t)}2==n.length&&(e.start=(this.distanceOfTwoPoints(n[0].point,i)<=this.distanceOfTwoPoints(n[0].point,s)?n[0]:n[1]).point,e.end=(this.distanceOfTwoPoints(n[0].point,i)>this.distanceOfTwoPoints(n[0].point,s)?n[0]:n[1]).point,e.isintersect=!0)}return e},Tt(r,t){if(0==t.length)return[r];var i,s,h=this.Ot(t),e=[];h.sort(function(t,i){var s=(t.Lt.x-r.Lt.x)*(t.Lt.x-r.Lt.x)+(t.Lt.y-r.Lt.y)*(t.Lt.y-r.Lt.y),h=(i.Lt.x-r.Lt.x)*(i.Lt.x-r.Lt.x)+(i.Lt.y-r.Lt.y)*(i.Lt.y-r.Lt.y),t=(t.At.x-r.Lt.x)*(t.At.x-r.Lt.x)+(t.At.y-r.Lt.y)*(t.At.y-r.Lt.y),i=(i.At.x-r.Lt.x)*(i.At.x-r.Lt.x)+(i.At.y-r.Lt.y)*(i.At.y-r.Lt.y);return(s<t?s:t)<(h<i?h:i)});let n=0;for(n=0;n<h.length;n++)this.distanceOfTwoPoints(h[n].Lt,h[n].At)<.01||(i=this.distanceOfTwoPoints(h[n].Lt,r.Lt),s=this.distanceOfTwoPoints(h[n].At,r.Lt),i<.01?r.Lt=h[n].At:s<.01?r.Lt=h[n].Lt:i<s?.1<this.distanceOfTwoPoints(r.Lt,h[n].Lt)&&(e.push({It:r.It,Lt:r.Lt,At:h[n].Lt,q:r.q,Pt:r.Pt}),r.Lt=h[n].At):.1<this.distanceOfTwoPoints(r.Lt,h[n].At)&&(e.push({It:r.It,Lt:r.Lt,At:h[n].At,q:r.q,Pt:r.Pt}),r.Lt=h[n].Lt),h.splice(n,1));return.1<this.distanceOfTwoPoints(r.Lt,r.At)&&e.push(r),e},Ot(t){var i=[];if(1==t.length)return t;let s=t[0],h=1;for(;0<t.length;){if(h>=t.length){if(i.push(s),t.splice(0,1),t.length<1)break;s=t[0],h=1}if(1===t.length){i.push(s);break}this.Y(s.Lt,s.At,t[h].Lt)?(this.Y(s.Lt,s.At,t[h].At)||(s.At=t[h].At),t.splice(h,1)):this.Y(s.Lt,s.At,t[h].At)?(s.Lt=t[h].Lt,t.splice(h,1)):this.Y(t[h].Lt,t[h].At,s.Lt)?(s=(this.Y(t[h].Lt,t[h].At,s.At)||(t[h].At=s.At),t[h]),t.splice(h,1)):this.Y(t[h].Lt,t[h].At,s.At)?(t[h].Lt=s.Lt,s=t[h],t.splice(h,1)):h++}return i},Y(t,i,s){let h=t.x-s.x,r=t.y-s.y,e=i.x-s.x,n=i.y-s.y;var a=this.distanceOfTwoPoints(t,s),s=this.distanceOfTwoPoints(i,s),t=this.distanceOfTwoPoints(t,i);return h*n-r*e<1e-5&&a+s-t<.001},Ft(t,i,s){let h=i.x-t.x,r=i.y-t.y;t=Math.sqrt(h*h+r*r);return{x:i.x+h/t*s,y:i.y+r/t*s}},Dt(i){let s=null,h=0,t=0,r=0;for(let t=0;t<i.length;t++)(null===s||i[t].x>s)&&(s=i[t].x,h=t);var e=new L(i[h].x,i[h].y,0),n=(t=0===h?i.length-1:h-1,r=h===i.length-1?0:h+1,new L(i[t].x,i[t].y,0)),a=new L(i[r].x,i[r].y,0),n=(new L).copy(e).sub(n),a=(new L).copy(a).sub(e);return 0<n.cross(a).z}});let P=new vt,F={Drive:1,Walk:0},dt={BROWSER:0,WX:1},pt=(Object.freeze(dt),{document:"undefined"!=typeof document?document:{},window:"undefined"!=typeof window?window:{},environment:dt.BROWSER,XMLHttpRequest:"undefined"!=typeof XMLHttpRequest?XMLHttpRequest:{}}),mt={RIGHT:2,LEFT:4,BOTTOM:8,TOP:16,RIGHT_BOTTOM:32,LEFT_BOTTOM:64,RIGHT_TOP:128,LEFT_TOP:256,CENTER:512},D=(Object.freeze(mt),{NONE:0,EXTRUDE_MARKER:2,FM3DTILE_LAYER:4,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,CAD_LAYER:1<<18,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30});D.LAYER_NODE_TYPE=new Map,D.LAYER_NODE_TYPE.set(D.EXTENT_LAYER,D.EXTENT),D.LAYER_NODE_TYPE.set(D.EXTERNAL_MODEL_LAYER,D.EXTERNAL_MODEL),D.LAYER_NODE_TYPE.set(D.MODEL_LAYER,D.MODEL),D.LAYER_NODE_TYPE.set(D.FACILITY_LAYER,D.FACILITY),D.LAYER_NODE_TYPE.set(D.LABEL_LAYER,D.LABEL),D.LAYER_NODE_TYPE.set(D.DOM_MARKER,D.DOM_MARKER),D.LAYER_NODE_TYPE.set(D.DYNAMIC_MODEL_MARKER,D.DYNAMIC_MODEL_MARKER),D.LAYER_NODE_TYPE.set(D.EXTRUDE_MARKER,D.EXTRUDE_MARKER),D.LAYER_NODE_TYPE.set(D.HEAT_MAP_MARKER,D.HEAT_MAP_MARKER),D.LAYER_NODE_TYPE.set(D.LINE_MARKER,D.LINE_MARKER),D.LAYER_NODE_TYPE.set(D.LOCATION_MARKER,D.LOCATION_MARKER),D.LAYER_NODE_TYPE.set(D.POLYGON_MARKER,D.POLYGON_MARKER),D.LAYER_NODE_TYPE.set(D.TEXT_MARKER,D.TEXT_MARKER),D.LAYER_NODE_TYPE.set(D.IMAGE_MARKER,D.IMAGE_MARKER),D.LAYER_NODE_TYPE.set(D.FLOW_LINE_LAYER,D.FLOW_LINE_MARKER),D.LAYER_NODE_TYPE.set(D.FIRE_MARKER,D.FIRE_MARKER),D.LAYER_NODE_TYPE.set(D.WALL_MARKER,D.WALL_MARKER),D.LAYER_NODE_TYPE.set(D.TUBE_MARKER,D.TUBE_MARKER),D.LAYER_NODE_TYPE.set(D.LINE3D_MARKER,D.LINE3D_MARKER),D.LAYER_NODE_TYPE.set(D.SPHERE_MARKER,D.SPHERE_MARKER),D.LAYER_NODE_TYPE.set(D.CAD_LAYER,D.CAD_LAYER);class S{constructor(t){this.St=t.type,this.stepLength=.7,this.Ct=180/Math.PI,this.Nt=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18056,9028,4514,2257,1128,564,282,141,70,35,17,8,4,2,1],this.kt=null,this.Yt=null,this.Vt=5,this.jt=!0,this.Zt=.2,this.Xt=!1,this.Ht=!0,this.zt=!1,this.Ut=1.2,this.Bt=80,this.qt=30,this.Qt=21,this.Kt=!0,this.Gt=22,this.Wt=1.3,this.Jt=null,this.$t="",this.ti=100,this.ii=3,this.si=1,this.hi=6,this.ri=10,this.ei=5,this.ni=0,this.ai=!1,this.oi=!1,this.ui=!1,this.li=!1,this.ci=0,this.fi=0,this.Mi=0,this.vi=0,this.di=null,this.pi=null,this.mi=!1,this.gi=null,this.yi=null,this._i=null,this.bi=null,this.Ei=!1,this.Ri=!1,this.wi=null,this.xi=0,this.Ti=h.ZH,this.Oi=i.MODULE_SHORTEST,this.Li=s.PRIORITY_DEFAULT,this.Ai=!1,this.Ii=!1,this.Pi=[],this.Fi=!1,this.Di=!1,this.Si=new Map,this.Ci=!0,this.crossCircles,this.Ni=e.Auto,this.ki={radius:.5,dash:{size:4,gap:2}},this.Yi="#002FA7",this.Vi=!0,this.ji=0,this.Zi=new N,this.Xi=new r,this.Hi=(window&&"undefined"!==window.fengmap?window:getApp().globalData).fengmap,this.on=this.on.bind(this),this.zi(t),this.Ui()}set locationMarker(t){this.Bi=t}get locationMarker(){return this.Bi}set lineFillMode(t){this.Ni=t}get lineFillMode(){return this.Ni}get naviResult(){return this.qi}get followPosition(){return this.jt}set followPosition(t){this.jt=t}get followAngle(){return this.Xt}set followAngle(t){this.Xt=t}on(t,i){this.Xi.h(t,i)}off(t,i){this.Xi.l(t,i)}dispose(){this.stop(),this.kt=null,this.Yt&&(this.Yt.dispose(),this.Yt=null)}setLanguage(t){this.Ti!=t&&(this.Ti=t,this.Qi())}setObstructions(t){this.Yt.setObstructions(t)}setStartPoint(t,i){this.Ki=Object.assign({},this.Ki,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.hi});let s=null;return s=t.url&&!i?this.Gi(this.Ki,!0):s}setDestPoint(t,i){this.Wi=Object.assign({},this.Wi,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.hi});let s=null;return s=t.url&&!i?this.Gi(this.Wi,!1):s}route(t,i,s){this.zi(t),this.Ji(),this.$i({mode:t.mode,priority:t.priority,toDoors:t.toDoors,obstruct:this.Ii,viapoints:t.viapoints,barrierFree:t.barrierFree,turnCost:t.turnCost},i,s)}naviConstraint(r,e){if(this.Ki&&this.Wi){null==this.ts&&this.ss(),r.buildingID=void 0!==r.buildingID?r.buildingID:null;var n={},a=[];let s=Number.MAX_VALUE,h=0;var o={index:-1,coords:{level:r.level,buildingID:r.buildingID},angle:null,distance:Number.MAX_VALUE,distanceToNext:Number.MAX_VALUE,remain:this.hs,relDirection:1,time:null,dots:[],insertIndex:-1,toNext:null,buildingIndex:-1};this.rs&&this.rs.coords.buildingID!==r.buildingID&&(this.rs.insertIndex=-1);for(let i=0;i<this.ts.length;i++){if(this.ts[i].bid!==r.buildingID);else{var u=this.ts[i].naviPoints;for(let t=1;t<u.length;t++){var l,c,f=u[t-1],M=u[t],v=f.index-h;this.rs&&this.rs.index>f.index||(v=this.es[i].result.naviDescriptionsData[v].endPoint,f.level===r.level&&M.level===r.level&&(l=P.W(r,f,M,n))<s&&(1===t||null===this.rs||this.rs&&this.rs.coords.buildingID===r.buildingID&&this.rs&&this.rs.insertIndex<=t)&&(e&&e!==f.index||(null!=this.ns&&(c=(r.x-this.ns.x)*(M.x-f.x)+(r.y-this.ns.y)*(M.y-f.y),0===Math.abs(c)&&null!=this.rs?o.relDirection=this.rs.relDirection:c<0&&(o.relDirection=-1)),o.distance=l,Object.assign(o.coords,n),o.angle=this.os(f,M),o.index=f.index,o.distanceToNext=P.q(n,v),o.insertIndex=t,o.toNext=P.q(n,M),o.buildingIndex=i,this.us(o),a.push(Object.assign({},o)),s=l)))}}h+=this.es[i].result.naviDescriptionsData.length}let i=o;if(this.rs)for(let t=a.length-2;0<=t;t--)a[t].remain>=i.remain&&a[t].remain<this.rs.remain&&(a[t].distance<=i.distance||Math.abs(4<=i.insertIndex-this.rs.insertIndex)&&i.buildingIndex==this.rs.buildingIndex)&&(i=a[t]);return i.time=r.time,this.ns=r,i.remain<.5?this.rs=null:this.rs=i,i}}pathConstraint(t,i){return this.Yt?this.Yt.pathConstraint(t,i):null}locate(t,i){this.oi&&this.stop(),this.ls(t,i),this.ns=t}locateNoConstraint(t,i){this.oi&&this.stop(),this.cs(t,i),this.ns=t}clearLocationMarker(){this.Bi&&(this.Bi.remove(),this.Bi=null)}clearMarkers(){this.fs&&(this.fs.remove(),this.fs=null,this.Ki=null),this.Ms&&(this.Ms.remove(),this.Ms=null,this.Wi=null)}drawNaviLine(t){if(this.Ki&&this.Wi)return this.vs=this.ds(this.gs,t),this.vs}clearNaviLine(){this.vs&&(this.vs.remove(),this.vs=null)}clearAll(){this.clearMarkers(),this.clearNaviLine(),this.clearLocationMarker()}overview(t,i){if(0!==this.gs.length){let s=new c;var h=[];for(let t=0;t<this.gs.length;t++){let i=[Number.MAX_VALUE,-Number.MAX_VALUE];this.gs[t].resultbuild.forEach(t=>{i[0]=Math.min(i[0],t.level),i[1]=Math.max(i[1],t.level),s.L(t.pointList)}),h.push({bid:this.gs[t].bid,levelRange:i})}this.ys(t,s,h,i)}}focusNaviLineSegment(h,t,r){if(0!=this.es.length){let i=null,s=null;for(let t=0;t<this.es.length;t++){var e=this.es[t].result.naviDescriptionsData;if(h-e.length<0){i=e[h],s=this.es[t].bid;break}h-=e.length}var n,a,o;s&&i&&((n=new c).L([i.startPoint,i.endPoint]),a=[Math.min(i.startLevel,i.endLevel),Math.max(i.startLevel,i.endLevel)],o=this.kt.getBuilding(s),this.ys(t,n,a,o,r))}}simulate(t){if(this.Ki&&this.Wi&&0!==this.gs.length){this.oi&&this.stop(),this.oi=!0,this.zi(t);let i={},s=(this.mi=!1,this.gi=this.kt.getRotation(),i.Ut||this.Ut);i.Qt=i.Qt||this.Qt||0,this._s(),this.Bi.rotateTo({heading:-this.gi}),this.jt?this.bs(this.Ki.level,this.Ki.buildingID,s,()=>{this.oi&&this.Es(this.Ki,s,()=>{if(this.oi){let t=i.Qt>this.Gt?this.Gt:i.Qt;this.Kt?this.Rs(this.Bt,s,()=>{this.oi&&this.ws(t,s,()=>{this.oi&&this.xs()})}):this.ws(t,s,()=>{this.oi&&this.xs()})}})}):this.oi&&this.xs()}}pause(){this.li=!0}resume(){this.li=!1}stop(){this.ai=!0,this.Zi.stop(),this.Ts&&this.kt.off("update",this.Ts),this.li=!1,this.pi=null,this.yi=null,this.Mi=0,this.mi=!1,this.wi=null,this.xi=0,this.Ei=!1,this.Ri=!1,this.Ts=null,this.oi=!1,this.ui=!1,this.ci=0,this.fi=0,this.di=null,this.rs=null}getSpeed(){return this.Vt}setSpeed(t){this.Vt=t}addZoomCircle(s){if(0!=s.length){var t=null==s[0].buildingID?null:s[0].buildingID;let i;this.Si.has(t)?i=this.Si.get(t):(i=new Map,this.Si.set(t,i));for(let t=0;t<s.length;t++)i.has(s[t].level)||i.set(s[t].level,[]),i.get(s[t].level).push(...s[t].circle)}}stopZoomCircle(){this.Ci=!1}constraintTrack(t){return this.Yt.constraintTrack(t)}setLineFillMode(t){this.Ni=t}setPassedLineDistance(t){this.vs&&this.Ni==e.SpecifiedDistance&&this.vs.moveProportion(t/this.hs)}}Object.assign(S.prototype,{zi(t){t&&(void 0!==t.map&&(this.kt=t.map),void 0!==t.analyser&&(this.Yt=t.analyser),void 0!==t.speed&&(this.Vt=t.speed),void 0!==t.followSpeed&&(this.Zt=t.followSpeed),void 0!==t.followPosition&&(this.jt=t.followPosition),void 0!==t.followAngle&&(this.Xt=t.followAngle),void 0!==t.locationMarkerFollowAngle&&(this.Ht=t.locationMarkerFollowAngle),void 0!==t.isMultiLevels&&(this.zt=t.isMultiLevels),void 0!==t.inTime&&(this.Ut=t.inTime),void 0!==t.tiltAngle&&(this.Bt=t.tiltAngle),void 0!==t.changeFloorTiltAngle&&(this.qt=t.changeFloorTiltAngle),void 0!==t.changeTiltAngle&&(this.Kt=t.changeTiltAngle),void 0!==t.zoom&&(this.Qt=t.zoom),void 0!==t.maxZoom&&(this.Gt=t.maxZoom),void 0!==t.extendScale&&(this.Wt=t.extendScale),void 0!==t.locationMarker&&(this.Jt=t.locationMarker),void 0!==t.locationMarkerUrl&&(this.$t=t.locationMarkerUrl),void 0!==t.locationMarkerSize&&(this.ti=t.locationMarkerSize),void 0!==t.locationMarkerHeight&&(this.ii=t.locationMarkerHeight),void 0!==t.lineMarkerHeight&&(this.si=t.lineMarkerHeight),void 0!==t.imageMarkerHeight&&(this.hi=t.imageMarkerHeight),void 0!==t.directionAssert&&(this.ri=t.directionAssert),void 0!==t.combineAsset&&(this.ei=t.combineAsset),void 0!==t.completeDistance&&(this.ni=t.completeDistance),void 0!==t.Ti&&(this.ri=t.directionAssert),void 0!==t.mode&&(this.Oi=t.mode),void 0!==t.priority&&(this.Li=t.priority),void 0!==t.toDoors&&(this.Ai=t.toDoors),void 0!==t.obstruct&&(this.Ii=t.obstruct),void 0!==t.viapoints&&(this.Pi=t.viapoints),void 0!==t.barrierFree&&(this.Fi=t.barrierFree),void 0!==t.lineStyle&&Object.assign(this.ki,t.lineStyle),void 0!==t.linePassed&&(this.Vi=t.linePassed),void 0!==t.lineFillMode)&&(this.Ni=t.lineFillMode)},Ui(){1===this.St?this.Os=void 0!==this.Hi.FMNaviDriveAnalyser&&this.Yt instanceof this.Hi.FMNaviDriveAnalyser:this.Os=void 0!==this.Hi.FMNaviAnalyser&&(this.Yt instanceof this.Hi.FMNaviAnalyser||this.Yt instanceof this.Hi.FMNaviWalkAnalyser),this.Ki=null,this.Wi=null,this.fs=null,this.Ms=null,this.Bi=null,this.Ts=null,this.Ji()},Ls(t){let i=this.kt.getBuilding(t.buildingID);t=(i=i||this.kt).getFloor(t.level);this.Bi.addTo(t)},_s(){!this.Bi&&this.Jt?this.Bi=this.Jt:this.Bi||this.Jt||(this.Bi=new this.Hi.FMLocationMarker({id:"location",buildingID:this.Ki.buildingID,level:this.Ki.level,x:this.Ki.x,y:this.Ki.y,url:this.$t||"",size:this.ti,height:this.ii})),this.Bi instanceof this.Hi.FMLocationMarker?this.Bi.addTo(this.kt):this.Bi.type==D.DYNAMIC_MODEL_MARKER&&this.Ls(this.Ki),this.Bi.moveTo({buildingID:this.Ki.buildingID,level:this.Ki.level,x:this.Ki.x,y:this.Ki.y})},As(i,...s){var h=s.length;for(let t=0;t<h;t++){var r=s[t];if(i[r])return i[r]}return s[s.length-1]},Is(t){if(this.Ki&&this.Wi)return t==this.Ki.level||t==this._detData.level},Ji(){this.qi=null,this.Ps=[],this.Fs=[],this.gs=[],this.Ds=[],this.es=[],this.ts=[],this.Ss=[],this.Cs=[],this.hs=0,this.Ns=[],this.rs=null,this.ns=null},Gi(i,s){if(i.level){var h=i.url||(s?"image/small/marker/nav_location_start.png":"image/small/marker/nav_location_dest.png");let t=s?this.fs:this.Ms;t&&t.remove();var r=(null!=i.buildingID?this.kt.getBuilding(i.buildingID):this.kt).getFloor(i.level);if(r)return(t=new this.Hi.FMImageMarker(Object.assign({map:this.kt,url:h,callback:function(){i.callback&&i.callback(t)},anchor:mt.BOTTOM,depth:!1,collision:!1},i))).addTo(r),s?this.fs=t:this.Ms=t,t}},$i(t,i,s){this.Ki&&this.Wi&&(t=Object.assign({start:Object.assign({},this.Ki),dest:Object.assign({},this.Wi)},t),this.ks(t,t=>{this.qi=t,this.Ys(),this.crossCircles=this.Vs(this.gs,this.Si),this.js(),this.Zs(),this.Xs(),this.ss(),i&&i(t)},t=>{s&&s(t)}))},Ys(){if(this.qi&&this.qi.subs&&0!=this.qi.subs.length){let i=this.qi.subs[0].buildingID,s=[];var h=[],r=[];for(let t=0;t<this.qi.subs.length;t++){var e=this.qi.subs[t];e.buildingID!==i&&(r.push({bid:i,result:s}),s=[],i=e.buildingID),s.push(e),t==this.qi.subs.length-1&&r.push({bid:i,result:s})}for(let t=0;t<r.length;t++){var n=this.Hs(r[t].result);h.push({bid:r[t].bid,resultbuild:n})}this.Ps=r,this.gs=h}},Hs(i){var s=[];let h=Number.NaN,r=null;for(let t=0;t<i.length;t++){var e=i[t];h!=e.levels[0]&&((r={length:0,level:e.levels[0],pointList:[]}).pointList.push(e.waypoint.points[0]),s.push(r),h=e.levels[0]),e.levels[0]==e.levels[1]?(r.pointList.push(...e.waypoint.points.slice(1)),r.length+=e.distance):(r={length:0,level:e.levels[0],pointList:[e.waypoint.points[0]]},s.push(r),r={length:0,level:e.levels[1],pointList:[e.waypoint.points[1]]},s.push(r))}return s},js(){for(let t=0;t<this.gs.length;t++){var i=this.gs[t].resultbuild;this.zs(i)}},zs(i){for(let t=0;t<i.length-1;t++){var s,h,r=i[t];r.length&&(s=r.pointList[r.pointList.length-1],h=i[t+1].pointList[0],.2<P.q(s,h))&&r.pointList.push(Object.assign({},h))}},Zs(){for(let t=0;t<this.gs.length;t++){var i=this.gs[t].resultbuild,i=this.Us(i);this.Ds.push({bid:this.gs[t].bid,groupsPoints:i})}},Us(i){var s=[];let h=null,r=null;for(let t=0;t<i.length;t++){var e=i[t],n=h==e.level;0==e.length&&0!=t&&t!=i.length-1||(n||(h=e.level,r&&s.push(r),r={level:e.level,pointList:[]}),r.pointList=r.pointList.concat(e.pointList))}return r&&s.push(r),s},Xs(){if(this.qi)for(let t=0;t<this.Ps.length;t++){var i=this.Ps[t].bid,s=this.Ps[t].result,s=this.Qi(s);this.es.push({bid:i,result:s}),this.hs+=s.naviDistance}},Qi(t){if(t){var r=[],e=[],n=[];let i=0;var a=this.Ti,o=t;let s=0,h=null;for(let t=0;t<o.length;t++){var u=o[t],l=u.waypoint.points,c=u.waypoint.direction[a],c=(r.push(u.instruction[a]),{startDirection:c[0],startIndex:void 0,startLevel:u.levels[0],startPoint:l[0],endDirection:c[1],endIndex:void 0,endLevel:u.levels[1],endPoint:l.slice(-1)[0],distance:u.distance});u.levels[0]==u.levels[1]?(c.startIndex=s,s+=l.length-1,c.endIndex=s):s=0,e.push(c),null!=h&&u.levels[0]==u.levels[1]||(h={level:u.levels[1],distance:0},n.push(h)),h.distance+=u.distance,i+=u.distance}return{naviDescriptions:r,naviDescriptionsData:e,naviFloorsDistance:n,naviDistance:i}}},ss(){if(this.Ps){let i=0;var s=[];for(let t=0;t<this.Ps.length;t++){var h=this.Ps[t].result,r=this.Ps[t].bid,e=this.Bs(h),n=this.qs(h);for(let t=0;t<e.length;t++)e[t].index+=i;for(let t=0;t<n.length;t++)n[t].index+=i;var a=this.es[t].result.naviDistance;i+=h.length,s.push({bid:r,distance:a,naviPoints:e,naviSubPoints:n})}this.ts=s}},Bs(t){if(!t)return[];var s=[],h=t;for(let i=0;i<h.length;i++){var r=h[i];if(r.levels[0]==r.levels[1]){var e=i+1==h.length?null:h[i+1],n=r.waypoint.points,a=null==e||e.levels[0]!=e.levels[1]?n.length:n.length-1;for(let t=0;t<a;t++){var o={x:n[t].x,y:n[t].y,z:0,level:r.levels[0],index:i};s.push(o)}}}return s},qs(t){if(!t)return[];var i=[],s=t;for(let t=0;t<s.length;t++){var h=s[t].waypoint.points,r={x:h[0].x,y:h[0].y,level:h[0].level,index:t};i.push(r),t==s.length-1&&(r={x:h.slice(-1)[0].x,y:h.slice(-1)[0].y,level:h.slice(-1)[0].level,index:s.length},i.push(r))}return i},Qs(i,s){let h=null;if(0!=i.length){var r=[];let t=0;for(;t<i.length;)i[t].distance==s&&r.push(i[t]),t+=1;if(1<r.length){for(let t=0;t<r.length;t++)if(0<=r[t].relDirection){h=r[t];break}h=h||r[0]}else 1==r.length&&(h=r[0])}return h},us(s){if(-1!=s.buildingIndex&&-1!==s.insertIndex){var h,r,e=s.buildingIndex,n=this.ts[e].naviPoints;let i=0;for(let t=n.length-1;t>s.insertIndex;t--)t-1>=s.insertIndex&&(h=n[t],r=n[t-1],h.level===r.level)&&(i+=P.q(h,r));n[s.insertIndex]&&n[s.insertIndex].level===s.coords.level&&(i+=P.q(n[s.insertIndex],s.coords));for(let t=e+1;t<this.ts.length;t++)i+=this.ts[t].distance;s.remain=i}},ds(i,t){if(0===i.length)return null;1!==this.St||this.ki.hasOwnProperty("color")||(this.ki.color=this.Yi);var s=Object.assign({},this.ki);t&&t.style&&Object.assign(s,t.style);let h=t&&t.height?t.height:this.si;var r=[];for(let t=0;t<i.length;t++){var e=i[t].bid,n=i[t].resultbuild;for(let t=0;t<n.length;t++){var a=n[t],o=a.pointList;if(0!==o.length){a=a.level;let s=[];o.forEach(t=>{var i=parseFloat(""+t.x),t=parseFloat(""+t.y);s.push({x:i,y:t,z:h})}),o.length<2&&(u=parseFloat(""+o[0].x),o=parseFloat(""+o[0].y),s.push({x:u,y:o,z:h}));var u=new this.Hi.FMSegment;u.level=a,u.points=s,u.buildingID=e,r.push(u)}}}s=new this.Hi.FMLineMarker(Object.assign({segments:r},s));return s.passed=t&&null!=t.passed?t.passed:this.Vi,s.addTo(this.kt),s},ks(t,i,s){this.Yt.route(t,t=>{this.Ai&&t.door&&(this.Wi.x=t.door.x,this.Wi.y=t.door.y),i&&i(t)},t=>{s&&s(t)})},Es(t,i,s){this.kt.setCenter({x:t.x,y:t.y,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:s})},Rs(t,i,s){this.kt.setTilt({tilt:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:s})},Ks(t,i,s){this.kt.setRotation({rotation:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:s})},ws(t,i,s){this.kt.setZoom({zoom:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:s},!0)},bs(t,i,s,h){let r,e;return(e=null==i?((r=this.kt).setVisibleLevels([t]),r.getLevel()):((r=this.kt.getBuilding(i)).setVisibleLevels([t]),r.level))==t?(h&&h(),null):r.setLevel({level:t,animate:"number"==typeof s,duration:"number"==typeof s?s:0,finish:h})},Gs(s){var i=this.Fs;if(0===i.length)return[];var h=[];let r=0;for(let t=0;t<i.length;t++){var e=i[t];if(!(e.pointList.length<=1)){var n=e.level;for(let t=0;t<e.pointList.length;t++){var a=e.pointList[t],a=new u(a.x,0,a.y);a.level=n;let i=-1;for(let t=1;t<s.length;t++)if(r<s[t].Ws){i=s[t-1].Js;break}a.Js=-1!==i?i:s[s.length-1].Js,h.push(a),r++}}}return h},$s(i,s){if(0===s)return i[0];let h=0,r=0,e=i[0];var n;for(let t=1;t<i.length;t++)if((n=i[t]).bid!==e.bid)e=n;else if(n.level!==e.level)e=n;else{var a,o=(a=n.clone().sub(e)).length();if((h+=o)>=s)return a.normalize(),(o=e.clone().add(a.clone().multiplyScalar(s-r))).level=n.level,o.index=n.Js!=e.index?e.index:n.Js,o.bid=(n.bid!=e.bid?e:n).bid,o;(e=n.clone()).level=n.level,e.index=n.Js,e.bid=n.bid,r=h}var t=i[i.length-1];return t.index=t.Js,t.bid=t.bid,t},th(t){if(!t||0===t.length)return[];let h=-1,r=0,e=-1;var t=t.map(function(t,i){var s=new u(t.startPoint.x,0,t.startPoint.y);return s.level=t.startLevel,s.Js=i,h=i,t.startLevel!==t.endLevel?(r+=e,s.Ws=r,r++):s.Ws=t.startIndex+r,e=t.endIndex,s}),i=this._naviDescriptionsData[this._naviDescriptionsData.length-1],s=new u(i.endPoint.x,0,i.endPoint.y);return s.level=i.endLevel,s.Js=h+1,s.Ws=i.endIndex+r,t.push(s),t},ih(s,h=!0){if(this.Bi)if(this.Ri)r={x:s.x,y:s.y,height:this.Bi.height,level:s.level,buildingID:s.bid},h&&this.Bi.moveTo(r),this.Ri=!1;else{var r={};let t=r.Ut||this.Ut,i=(r.Qt=r.Qt||this.Qt||0,r.Qt>this.Gt?this.Gt:r.Qt);this.zt||(h&&this.sh(s),this.Bi.visible=!0),this.Kt&&this.Rs(this.Bt,t,null),this.Es(s,t,()=>{this.ws(i,t,()=>{this.Ei=!1})})}},hh(t){this.Bi&&(this.sh(t),this.Ri=!1)},os(t,i){var s=new u(0,0,1),t=new u(t.x,0,t.y),i=new u(i.x,0,i.y).clone().sub(t).normalize(),t=i.angleTo(s)*P.F();return 0<i.clone().cross(s).y?360-t:t},rh(t,i,s){return t===i?t:(180<Math.abs(i-t)&&(t<i?t+=360:i+=360),(t*(1-s)+i*s)%360)},eh(t,i){var s=this.Nt;let h=Math.floor(t);var r=s[h-1]*(1-t%1)+s[h]*(t%1);for(r*=i,h=0;r<s[h];)h++;return h+1-(r-s[h])/(s[h-1]-s[h])},nh(t){var i,s,h;this.ai||pt.window.requestAnimationFrame(this.nh.bind(this,t)),this.ui||(t.cnt++,t.cnt!==t.step)||(t.cnt=0,i=this.Zi.getDelta(),this.Ri)||this.Ei||this.li||(this.Mi+=this.Vt*i,this.Mi<=0)||this.Vt*i==0||(i=Object.assign({},this.$s(t.ps,this.Mi)),h=this.hs-this.Mi,s=i.y,i.y=i.z,i.z=s,this.di={distance:0,remain:h<this.vi?this.vi:h,walk:this.Mi,point:i,level:i.level,buildingID:i.bid,index:i.index-1},null!=this.pi&&(this.yi=this.os(this.pi,i)),this.pi=Object.assign({},i),!i||h<this.vi&&this.mi?this.ui=!0:(h<this.vi&&!this.mi&&(this.mi=!0),this.xi||(this.xi=t.ps[0].level),null==this.wi&&(this.wi=t.ps[0].bid||"outdoor"),this.oi&&(s=i.bid||"outdoor",this.wi!==s?(this.Ri=!0,this.wi=s,this.ci++,this.fi=0,this.xi=i.level,this.ah(1,i),this.Xi.M({type:"transit",level:i.level,buildingID:i.bid})):(this._i!==i.bid&&this.jt&&(this.pi=Object.assign({},i),this.ah(1,i,!1)),this.xi!==i.level&&(this.xi=i.level,this.fi++,this.ah(0,i),this.Xi.M({type:"transit",level:i.level,buildingID:i.bid})),this.bi!==i.level&&this.jt&&(this.pi=Object.assign({},i),this.ah(0,i,!1)),this.jt&&this.kt.focusBuilding&&this.kt.focusBuilding.buildingID==i.bid&&this.kt.focusBuilding.level!==i.level&&(this.xi=this.di.level,h={x:this.Bi.x,y:this.Bi.y,z:0,level:i.level,bid:i.bid,index:i.index},this.fi++,this.ah(0,h),this.Xi.M({type:"transit",level:h.level,buildingID:h.bid}))))))},ah(s,h,r=!0){if(this.jt){var e={};let t=e.Ut||this.Ut,i=(e.Qt=e.Qt||this.Qt||0,e.Qt>this.Gt?this.Gt:e.Qt);if(1===s)return this._i=h.bid,this.oh(h.level,h.bid,()=>{this.bs(h.level,h.bid,t,()=>{this.ih(h,r)})});this.bi=h.level,this.Ei=!0,this.Kt&&this.Rs(this.qt,t,null),this.zt||(this.Bi.visible=!1),r||(this.Bi.visible=!0),this.oh(h.level,h.bid,()=>{this.bs(h.level,h.bid,t,()=>{this.ws(i,t,()=>{this.Es(h,t,()=>{this.Kt?this.Rs(this.Bt,t,()=>{this.ih(h,r)}):this.ih(h,r)})})})})}else if(1===s)return this.oh(h.level,h.bid,()=>{this.ih(h)})},uh(){this.ai=!1;var t=[];for(let i=0;i<this.ts.length;i++){var s=this.ts[i].naviPoints,h=[];for(let t=0;t<s.length;t++){var r=new u(s[t].x,0,s[t].y);r.Js=s[t].index,r.level=s[t].level,r.bid=this.ts[i].bid,h.push(r)}t.push(...h)}this.Zi.start(),this.ui=!1,this.ci=0,this.fi=0,this.nh({step:2,cnt:0,ps:t})},lh(){if(!(this.Ei||this.Ri||this.li)){if(this.pi){var t=new u(this.Bi.x,this.Bi.y,0).lerp(this.pi,this.mi?1:this.Zt),h=(t.level=this.pi.level,t.buildingID=this.pi.bid,this.naviConstraint(t,this.pi.index));if(h.index<0)return;this.Bi.moveTo({x:t.x,y:t.y,height:this.ii,level:t.level,buildingID:t.buildingID}),this.vs&&(this.vs.passed?this.vs.moveProportion(1-h.remain/this.hs):this.vs.moveProportion(0));let i,s;if(this.Ci)for(let t=0;t<this.crossCircles.length;t++)h.coords.buildingID==this.crossCircles[t].bid&&h.coords.level==this.crossCircles[t].level&&h.remain<=this.crossCircles[t].point.remain&&h.remain>=this.crossCircles[t].remain&&(i=!0,s=this.crossCircles[t].point);if(this.Xi.M(Object.assign({},this.di,this.fh(h,i,s))),i=!1,s=null,this.jt?this.Es(t):this.kt.updateCountDown_=0,this.ui)return this.stop(),void this.Xi.M({type:"complete"})}null!=this.yi&&(t=this.rh(this.gi,this.yi,this.Zt),this.gi=t,this.Bi.rotateTo({heading:-t}),this.Xt)&&this.Ks(t)}},xs(){this.uh(),this.Ts=this.lh.bind(this),this.kt.on("update",this.Ts)},ls(t,i){this.rs=null;var s=this.naviConstraint(t);this.Ni==e.Auto&&this.vs&&(this.vs.passed?this.vs.moveProportion(1-s.remain/this.hs):this.vs.moveProportion(0));let h,r;if(this.Ci)for(let t=0;t<this.crossCircles.length;t++)s.coords.buildingID==this.crossCircles[t].bid&&s.coords.leve==this.crossCircles[t].level&&s.remain<=this.crossCircles[t].point.remain&&s.remain>=this.crossCircles[t].remain&&(h=!0,r=this.crossCircles[t].point);this.Xi.M(this.fh(s,h,r)),h=!1,r=null,this.Bi&&(s.coords.height=this.ii,this.Bi.moveTo(s.coords),void 0!==i?this.Bi.rotateTo({heading:i}):this.Bi.rotateTo({heading:-s.angle}))},cs(t,i){var s=this.naviConstraint(t);let h,r;if(this.Ci)for(let t=0;t<this.crossCircles.length;t++)s.coords.buildingID==this.crossCircles[t].bid&&s.coords.leve==this.crossCircles[t].level&&s.remain<=this.crossCircles[t].point.remain&&s.remain>=this.crossCircles[t].remain&&(h=!0,r=this.crossCircles[t].point);this.Xi.M(this.fh(s,h,r)),h=!1,r=null,this.Bi&&(t.height=this.ii,this.Bi.moveTo(t),void 0!==i?this.Bi.rotateTo({heading:i}):this.Bi.rotateTo({heading:-s.angle}))},Mh(t,r){var e=[{x:t.min.x,y:t.min.y},{x:t.min.x,y:t.max.y},{x:t.max.x,y:t.max.y},{x:t.max.x,y:t.min.y}],n=new c;for(let h=0;h<r.length;h++){var a=r[h].levelRange;for(let s=0;s<a.length;s++){let i=0;i=s===a.length-1?this.si+2*this.ki.radius:this.si;for(let t=0;t<e.length;t++){var o=this.Hi.FMUtil.coordsMapToScreen(this.kt,{x:e[t].x,y:e[t].y,buildingID:r[h].bid,level:a[s],height:i});o&&n.L([o])}}}return n},dh(t,i){var t=this.Mh(t,i).size,i=this.kt.getContainer().clientHeight,s=this.kt.getContainer().clientWidth;return s/i>t.x/t.y?t.y/i:t.x/s},ph(t,i,s,h,r,e){var n=this.dh(t,i);let a=this.kt.getZoom();n?(a=this.eh(this.kt.getZoom(),n*(s||1)),r=h-1):a-=1,this.kt.setZoom({zoom:a,animate:!1,finish:()=>{++r===h?e&&e({zoom:a}):this.ph(t,i,s,h,r,e)}})},mh(t,i){var s=this.Mh(t,i),h=[];for(let t=0;t<i.length;t++){var r=i[t].levelRange,e=i[t].bid||this.kt.getMapOptions().buildingID;for(let t=0;t<r.length;t++){var n=this.kt.getBuilding(e).getFloor(r[t]).height;h.push(this.Hi.FMUtil.coordsScreenToMap(this.kt,{x:(s.max.x+s.min.x)/2,y:(s.max.y+s.min.y)/2,z:n+2*this.ki.radius}))}}var a=new u;for(let t=0;t<h.length;t++)a.add(h[t]);return a.divideScalar(h.length),a},gh(s,h,r,e,n,a){this.ph(s,h,r,10,0,t=>{let i=this.mh(s,h);this.kt.setCenter({animate:!1,x:i.x,y:i.y,finish:()=>{++n===e?a&&a({zoom:t.zoom,center:i}):this.gh(s,h,r,e,n,a)}})})},ys(t,n,a,o){let u=t&&void 0!==t.ratio?t.ratio:1,i=t&&void 0!==t.rotation?t.rotation:0,s=t&&void 0!==t.tilt?t.tilt:30,l=!t||void 0===t.animate||t.animate,h=1,r=[1];for(let i=0;i<a.length;i++){var e=a[i].levelRange,c=[];let t=e[0];for(;t<=e[1];)c.push(t),t++;null==a[i].bid?(r=c,h=c[Math.floor((c.length-1)/2)]):this.kt.getBuilding(a[i].bid).setVisibleLevels(c)}this.kt.setVisibleLevels(r,()=>{this.kt.setLevel({level:h,animate:l,finish:()=>{var t=r.length%2==0?this.kt.getFloorSpace()/2:0;this.kt.getInteracations().controls.panAdd({x:0,y:t,z:0}),this.kt.setCenter({animate:l,x:n.center.x,y:n.center.y,finish:()=>{this.kt.setTilt({tilt:s,animate:l,finish:()=>{this.kt.setRotation({rotation:i,animate:l,finish:()=>{let i=this.kt.getInteracations(),s=this.kt.copyCamera(),h=i.copyControls(s),r=i.controls,e=this.kt.camera;i.controls=h,this.kt.camera=s,this.kt.getInteracations().controls.update(),this.gh(n,a,u,10,0,t=>{i.controls=r,this.kt.camera=e,h.dispose(),h=null,s=null,this.kt.enableUpdateRender(),this.kt.setZoom({animate:l,zoom:t.zoom,duration:.5}),this.kt.setCenter({animate:l,x:t.center.x,y:t.center.y,duration:.5,finish:()=>{o&&o()}})})}})}})}})}})})},oh(i,t,s){if(null==i||null==t)return s&&s(),null;var h=this.kt.getBuilding(t).levelChart,r=this.kt.getVisibleLevels();let e=null;for(let t=0;t<h.length;t++)if(t%2==1&&h[t]===i&&(e=h[t-1],r.indexOf(e)<0)){this.kt.setVisibleLevels([e]);break}return null==e||this.kt.getLevel()===e?(s&&s(),null):this.kt.setLevel({level:e,animate:"number"==typeof duration,duration:"number"==typeof duration?duration:0,finish:s})},Vs(i,s){if(!s)return[];let h=0,r=0;var e=[];for(let t=0;t<i.length;t++){var n=i[t].resultbuild;for(let t=0;t<n.length;t++)r+=n[t].length}for(let t=0;t<i.length;t++){var a=i[t].bid,o=i[t].resultbuild;for(let t=0;t<o.length;t++){var u=o[t].level,l=o[t].pointList;if(0<t&&(h+=o[t-1].length),!(l.length<=1)&&(s.has(a)&&s.get(a).has(u))){let i=0;var c=s.get(a).get(u);for(let t=0;t<l.length;t++){0<t&&(i+=P.distance(l[t-1],l[t]));for(var f of c){var M,v=this.yh(l,f,t);v&&(0==t?v.remain=r-(h+i):v.remain=r-(h+i-v.disIntersectToPoint),M=r-(h+i-v.disCenterToPoint),e.push({center:f.center,radius:f.radius,remain:M,point:v,level:u,bid:a}))}}}}}return e},yh(i,s,h){let r=0;if(0==h)return P.K(i[h],s.center)<=.001?Object.assign({disIntersectToCenter:disIntersectToCenter,disIntersectToPoint:r},i[h]):null;if(!(P.K(s.center,i[h-1])<=.001)&&P.G(s.center,i[h-1],i[h])<=.001)for(var e of s.points)if(!P.H(e,s.center,i[h]))for(let t=h;0<t;t--)if(P.H(e,i[t-1],i[t])&&P.G(e,i[t-1],i[t])<=.001){var n=t,a=[e];for(let t=n;t<=h;t++)a.push(i[t]);for(let t=0;t<a.length-1;t++)r+=P.distance(a[t],a[t+1]);return e.disIntersectToPoint=r,e.disCenterToPoint=P.distance(s.center,i[h]),e}return null},sh(t){let i={x:this.Bi.x,y:this.Bi.y,height:this.Bi.height,level:t.level,buildingID:t.bid};t=this.Ds[this.ci].groupsPoints[this.fi];t&&t.pointList&&0<t.pointList.length&&(i=Object.assign(i,t.pointList[0])),this.Bi.moveTo(i)},fh(t,i,s){i={distance:t.distance,remain:t.remain,distanceToNext:t.distanceToNext,angle:t.angle,point:t.coords,level:t.coords.level,buildingID:t.coords.buildingID,index:t.index,enterCircle:i,intersect:s};return this.St===F.Drive?(i.type="driving",i.drive=this.hs-t.remain):(i.type="walking",i.walk=this.hs-t.remain),i}});class gt extends S{constructor(t,i,s){super(t,i,s)}on(t,i){super.on(t,i)}off(t,i){super.off(t,i)}}class yt extends S{constructor(t,i,s){t.type=F.Drive,super(t,i,s),this.Vt=7,this.Zt=.2}on(t,i){super.on(t,i)}off(t,i){super.off(t,i)}locate(t,i){super.locate(t,i)}route(t,i,s){super.route(t,i,s)}locateNoConstraint(t,i){super.locateNoConstraint(t,i)}simulate(t){super.simulate(t)}get naviResult(){return this.qi}}class _t extends S{constructor(t,i,s){t.type=F.Walk,super(t,i,s)}on(t,i){super.on(t,i)}off(t,i){super.off(t,i)}route(t,i,s){super.route(t,i,s)}}function bt(i){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");if((i=(i=(i=""+i).replace(/[ \t\n\f\r]/g,"")).length%4==0?i.replace(/==?$/,""):i).length%4==1||/[^+/0-9A-Za-z]/.test(i))return null;let s="",h=0,r=0;for(let t=0;t<i.length;t++)h=(h<<=6)|Rt(i[t]),24===(r+=6)&&(s=(s=(s+=String.fromCharCode((16711680&h)>>16))+String.fromCharCode((65280&h)>>8))+String.fromCharCode(255&h),h=r=0);return 12===r?(h>>=4,s+=String.fromCharCode(h)):18===r&&(h>>=2,s=(s+=String.fromCharCode((65280&h)>>8))+String.fromCharCode(255&h)),s}let Et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Rt(t){t=Et.indexOf(t);return t<0?void 0:t}var wt=bt;function xt(t){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");let i;for(t=""+t,i=0;i<t.length;i++)if(255<t.charCodeAt(i))return null;let s="";for(i=0;i<t.length;i+=3){var h=[void 0,void 0,void 0,void 0];h[0]=t.charCodeAt(i)>>2,h[1]=(3&t.charCodeAt(i))<<4,t.length>i+1&&(h[1]|=t.charCodeAt(i+1)>>4,h[2]=(15&t.charCodeAt(i+1))<<2),t.length>i+2&&(h[2]|=t.charCodeAt(i+2)>>6,h[3]=63&t.charCodeAt(i+2));for(let t=0;t<h.length;t++)void 0===h[t]?s+="=":s+=Ot(h[t])}return s}let Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Ot(t){if(0<=t&&t<64)return Tt[t]}var Lt=xt;let At=bt,It=xt;var Pt={atob:At,btoa:It},Ft=0,Dt=function(t){var i=(new Date).getTime(),s=Math.max(0,16-(i-Ft)),h=setTimeout(function(){t(i+s)},s);return Ft=i+s,h},St=function(t){clearTimeout(t)};let C=wx.getSystemInfoSync(),Ct={AudioContext:function(){},URL:{},atob:Pt.atob,devicePixelRatio:C.pixelRatio,requestAnimationFrame:Dt,cancelAnimationFrame:St,screenWidth:C.screenWidth,screenHeight:C.screenHeight,systemInfo:C},Nt={FMNaviMode:i,FMNaviPriority:s,FMLanguageType:h,FMPassedLineFillMode:e,FMNavigation:gt,FMNavigationDrive:yt,FMNavigationWalk:_t},kt=(pt.window=Ct,{});for(let t in Nt)kt[t]=Nt[t];exports.FMLanguageType=h,exports.FMNaviMode=i,exports.FMNaviPriority=s,exports.FMNavigation=gt,exports.FMNavigationDrive=yt,exports.FMNavigationWalk=_t,exports.FMPassedLineFillMode=e,exports.default=kt;
